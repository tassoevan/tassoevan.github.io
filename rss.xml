<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Tasso & As Vozes]]></title><description><![CDATA[Um lugar calmo e tranquilo onde dialogo com as vozes que habitam a minha cabeça]]></description><link>http://github.com/dylang/node-rss</link><generator>GatsbyJS</generator><lastBuildDate>Sun, 01 Sep 2024 17:58:24 GMT</lastBuildDate><item><title><![CDATA[Notas sobre "The Great CoffeeScript to Typescript Migration of 2017"]]></title><description><![CDATA[Fonte: https://dropbox.tech/frontend/the-great-coffeescript-to-typescript-migration-of-2017 Pré-história: adoção de CoffeeScript
Em 2012, o…]]></description><link>https://tassoevan.me/2020-05-24/notas-sobre-the-great-coffeescript-to-typescript-migration-of-2017/</link><guid isPermaLink="false">https://tassoevan.me/2020-05-24/notas-sobre-the-great-coffeescript-to-typescript-migration-of-2017/</guid><pubDate>Sat, 23 May 2020 22:01:01 GMT</pubDate><content:encoded>
Fonte: https://dropbox.tech/frontend/the-great-coffeescript-to-typescript-migration-of-2017

## Pré-história: adoção de CoffeeScript

- Em 2012, o Dropbox era uma startup com 150 funcionários.
- ES5 e jQuery dominavam o desenvolvimento JavaScript.
- A codebase consistia de cerca de 100 mil linhas de JavaScript empacotada por simples concatenação de arquivos.
- Dois engenheiros migraram tudo para CoffeeScript em uma semana.
- Em 2013, adotaram o sistema de módulos RequireJS (AMD) já que CommonJS era restrita a Node e, portanto, não projetada para uso no browser.

## Rumores de uma mudança de linguagem

- Ao final de 2015, ES6 já tinha mais funcionalidades que CoffeeScript.
- Alguns times começaram a adotar ES6 em projetos isolados.
- A codebase era difícil de manter pois as técnicas de codificação defensiva eram insuficientes e prejudicavam a legibilidade do código.
- Por CoffeeScript ser menos estrita que Python no uso de whitespaces, alguns engenheiros verificavam manualmente o código JavaScript gerado; é citado um bug sério no outono de 2013 causado por um espaço em branco mal-posicionado.
- Uma pesquisa interna em novembro de 2015 verificou que 62% dos desenvolvedores gostariam de mudar a linguagem utilizada.
- Problemas com CoffeeScript apontados:
  - Falta de delimitadores
  - _Syntactic sugar_ muito opinativo
  - Falta de suporte da comunidade
  - Leitura difícil pois a sintaxe é muito densa
  - Sujeita a erros por causa de ambiguidades sintáticas
- O ferramental de TypeScript parecia melhor que vanilla ES6 + Flow no final de 2015.
- No primeiro semestre de 2016, um engenheiro integrou Babel e TypeScript.
- Tanto o time quanto a codebase (330 mil linhas) haviam crescido significativamente para uma migração indolor.

## Um plano de migração otimista

- Foram estabelecidas cinco _milestones_ a serem cumpridas até julho de 2017:
  M1. Suporte básico a TypeScript com interoperabilidade com CoffeeScript e ferramentas de i18n, lint e testes;
  M2. Documentar boas práticas e guias de migração e migrar as principais bibliotecas e módulos para TypeScript ser a linguagem padrão de desenvolvimento;
  M3. Consolidar a _milestone_ anterior migrando o restante de módulos e bibliotecas;
  M4. Migrar os arquivos mais modificados ao longo do tempo no projeto;
  M5. Remover o compilador de CoffeeScript.
- M1, M2 e M3 foram executadas no segundo semestre de 2016.
- M4 e M5 foram mais problemáticas; esperava-se que o código ficaria a cargo dos times que o desenvolveram originalmente.
- 20% do time de produto foi alocado para trabalhar nas &quot;fundações&quot; da codebase.

## Interoperabilidade de CoffeeScript/TypeScript

- Para cada arquivo de CoffeeScript (`*.coffee`), foi criado um arquivo de declarações (`*.d.ts`) exportando os módulos como `any`.
- Módulos em TS com `export default value;` eram importados nos módulos AMD como objetos do tipo `{ default: value }`; named exports foram migrados com poucos problemas.
- Em módulos cujos exports eram dinamicamente determinados, exportou-se todos os identificadores possíveis mas com valores `undefined` dinamicamente determinados.

## Banindo novos arquivos em CoffeeScript

- Foi criado um teste automático para barrar a adição de novos arquivos.
- Este teste quebrou quando uma migração paralela para [Bazel](https://bazel.build/) como sistema de build foi executada, pois a lista de arquivos `*.coffee` estava vazia.
- Como aprendizado, testes passaram a fazer asserções em suposições (neste caso, de que a lista nunca seria vazia).
- A redução da _whitelist_ de arquivos permitidos gerava pequenos atrasos no code review.

## Experiência inicial: não perdemos o _syntactic sugar_ do CoffeeScript

- A perda de _optional chaining_ e _nullish coalescing_ foi compensada com a adição de tipagem.

## Prioridades concorrentes

- No final de 2016, foi criado um time para redesign e reescrita do website em React (&quot;Maestro&quot;).
- O time do Maestro não conseguiu cumprir o prazo do primeiro trimestre, entregando ao término do segundo o projeto completo em React e TypeScript.
- A lista de arquivos que deveria ser eliminada na M4 estagnou em 100 arquivos, mas na prática ainda haviam 2000 arquivos em CoffeeScript com manutenção constante.

## Adiando a M5

- Interpretou-se erroneamente que os scripts restantes deveriam ser substituídos pelos arquivos compilados, causando problemas com lint e i18n.
- Não ficou claro que o objetivo da M5 era reduzir o custo (já pago) de manter o ferramental de CoffeeScript e TypeScript.
- A migração perdeu seu ETA.
- A estimativa inicial da migração era de 1000 linhas por dia demandando um ano de trabalho de um único engenheiro; na prática, 100 linhas por dia eram convertidas, significando um tempo de 10 anos ou o trabalho de 10 engenheiros em um ano.
- Não havia clareza sobre o que era o trabalho &quot;fundamental&quot; que demandaria 20% do time: se infraestrutura ou pagamento de dívida técnica.
- Uma migração de sistemas em produção para uma nova distribuição do Ubuntu tomou boa parte da mão-de-obra de infraestrutura.

## Um novo plano com `decaffeinate`

- Em janeiro de 2017, foi sugerido o uso de `decaffeinate` para as conversões.
- Uma função de ordenação com i18n não-testada quebrou completamente uma página no browser Safari.
- A longa lista de bugs semelhantes no `decaffeinate` obrigou se adotar uma conversão mista (manual e automática) que eventualmente ocasiona erros a nível de semântica do código.
- Seis meses depois, `decaffeinate` parecia suficientemente maduro em comparação à conversão manual.
- O time entrou em acordo: TypeScript apenas com o tipo `any` era preferível a CoffeeScript não-tipado e habilitaria os times a introduzirem tipos no seu próprio ritmo.

## Um plano em duas fases

- A pipeline de migração de código consistia de múltiplas etapas:
  1. Conversão para JavaScript ES6;
  2. Transformações com `codemod`, especialmente de funções com binding para _arrow functions_;
  3. Transformação da API legada de React para JSX;
  4. Conversão de AMD para módulos ES (especial cuidado com exports);
  5. Anotação de parâmetros de função com `any`;
  6. Adição de declaração de membros de classes;
  7. Anotação de componentes com tipos específicos de React;
  8. Adição de comentário explicado como olhar o código CoffeeScript original através do `git`;
- A etapa final de correção dos tipos envolveu escrever scripts para interpretar os erros vindos do _type checking_ e aplicar as correções automaticamente.

## Mantendo o foco

- O compromisso de manter uma ferramenta suficientemente boa tornou trivial resolver manualmente problemas como variáveis mortas.
- Agrupar a quantidade de erros do `tsc` por código de erro gerou uma métrica para a migração e confiança de que estavam na direção correta.
- A taxa de erros por arquivo ficou entre 0,5 e 1.

## Ganhando confiança nas suas ferramentas

- Bugs pré-existentes eram capturados rodando testes antes e após as conversões.
- Se um erro ocorria em muitos lugares, uma asserção era adicionada à pipeline de migração em vez de realizar correção manual.
- Um bug notável destes é relacionado a CoffeeScript não ter suporte a _variable shadowing_.
- O código foi inteiramente portado para o _strict mode_ sem problemas como atribuição em propriedades _read-only_.
- As primeiras conversões em massa foram feitas nos testes automáticos.
- Uma boa configuração do [itest](https://www.youtube.com/watch?v=muvU1DYrY0w) permitia checar rapidamente quais modificações eram a origem dos problemas.
- Foi importante ter rigor na escrita das traduções de código, cobrindo todos os _corner cases_ e explicitando quais casos eram ignorados.

## A última parte

- Nas últimas semanas as ferramentas eram capazes de converter entre 100 e 200 arquivos numa única passagem.
- Um dos truques para iterar rapidamente é rodar o _typecheck_ incremental (`tsc --noEmit --watch`).
- O número de arquivos em CoffeeScript era mantido atualizado num quadro branco.
- Apenas dois bugs entraram em produção.
- Ao time mais resistente à mudança foi prometido que erros ficariam a cargo dos engenheiros envolvidos na migração.
- Ao se admitir como produto um código TypeScript não-idiomático, foram gastos 2 meses de trabalho de três engenheiros (cerca de 19 engenheiros-semana).
- &quot;Nós devemos economizar nosso capital político e organizacional com trabalhos que não podemos automatizar para todos&quot;; assim, a conversão manual foi descartada.
- Atualmente, o time da Dropbox mantém 2kk linhas de TypeScript.
</content:encoded></item><item><title><![CDATA[Uma sugestão para simular um e-paper]]></title><description><![CDATA[É necessário o alinhamento de software e hardware para ficar perfeito, mas utilizar apenas um deles já confere uma boa aproximação do efeito…]]></description><link>https://tassoevan.me/2020-05-23/uma-sugestao-para-simular-um-e-paper/</link><guid isPermaLink="false">https://tassoevan.me/2020-05-23/uma-sugestao-para-simular-um-e-paper/</guid><pubDate>Sat, 23 May 2020 01:39:51 GMT</pubDate><content:encoded>
É necessário o alinhamento de software e hardware para ficar perfeito, mas utilizar apenas um deles já confere uma boa aproximação do efeito desejado.

## Software

O fundo deve ser um tom de cinza claro como `rgb(236, 236, 236)` ou mais claro, enquanto a cor do texto deve ser 25% a 30% mais clara que o preto.

A fonte de corpo de texto deve ter uma aparência suave. Há uma preferência para fontes serifadas porém acredito que isto não deveria ser uma regra geral. A tipografia deve acompanhar o significado que o texto transmite onde é possível ser determinado e definida pelo leitor/usuário quando não é inferível o tom de voz do texto. Particularmente acredito que fontes serifadas são ótimas para textos de estrutura mais linear -- como ficções e artigos com poucos recursos gráficos. Uma fonte mono-espaçada seria aconselhável quando o texto deve ser _escaneado_ pelo leitor, e.g., tabelas de dados e índices.

O espaçamento de linha ideal está entre 125% e 150% do tamanho da fonte. Em geral, uma margem mínima de 10pt em todas as direções de qualquer bloco de texto é suficiente para demarcar as divisões semânticas do texto.

## Hardware

Uma película protetora anti-reflexiva combinada com a variação de brilho entre 45% para interiores e 75% para iluminação exterior.
</content:encoded></item><item><title><![CDATA[Dark mode não-adaptativo: uma escolha puramente estética]]></title><description><![CDATA[Advoga-se por aí que todas as interfaces digitais devem ao menos prover um modo escuro, o famigerado dark mode. Não sei ao certo a origem…]]></description><link>https://tassoevan.me/2020-05-23/dark-mode-nao-adaptativo-uma-escolha-puramente-estetica/</link><guid isPermaLink="false">https://tassoevan.me/2020-05-23/dark-mode-nao-adaptativo-uma-escolha-puramente-estetica/</guid><pubDate>Fri, 22 May 2020 23:55:25 GMT</pubDate><content:encoded>
Advoga-se por aí que todas as interfaces digitais devem ao menos prover um modo escuro, o famigerado _dark mode_. Não sei ao certo a origem dessa &quot;necessidade&quot; pós-2018, mas não é difícil conjecturar que deva ter surgido no meio do desenvolvimento de software. A justificativa? Descanso visual por uso prolongado de displays.

Acredito que a necessidade real seja outra; me baseio na escolha que muitos conhecidos fotossensíveis têm por trabalhar em ambientes escuros apesar de usar displays com nível de brilho alto, o que, além de destruir o ciclo circadiano, causa cansaço da musculatura complexa dos olhos.

O descanso deve ser para outro órgão: o cérebro do programador, que deve interpretar sintaticamente blocos de texto diferenciando palavras-chaves, identificadores, delimitadores, literais. O modo escuro seria um acessório ao realce de sintaxe, uma vez que o texto colorido é melhor diferenciado contra um fundo preto ou cinza escuro.

Para textos lineares, como os de literatura ou com poucos elementos gráficos e tópicos, tons de sépia e tons simulando o e-ink são muito mais adequados para relaxamento visual. Desta forma, o modo do tema deveria ser adaptativo ao conteúdo, mas ainda prefere-se que ele seja definido pelo contexto, como as cores do sistema ou o modo noturno.
</content:encoded></item><item><title><![CDATA[Instalando o Composer... com o Composer]]></title><description><![CDATA[Não apenas o Composer, mas uma série de ferramentas para desenvolvimento em PHP pode ser mantida atualizada utilizando o próprio Composer…]]></description><link>https://tassoevan.me/2015-08-14/instalando-o-composer-com-o-composer/</link><guid isPermaLink="false">https://tassoevan.me/2015-08-14/instalando-o-composer-com-o-composer/</guid><pubDate>Fri, 14 Aug 2015 20:00:00 GMT</pubDate><content:encoded>
Não apenas o Composer, mas uma série de ferramentas para desenvolvimento em PHP pode ser mantida atualizada utilizando o próprio Composer. Uma vez que se assume que essas ferramentas são utilizadas em todos os projetos, muitas vezes a adição delas como dependência de desenvolvimento (e.g `composer require --dev phpunit/phunit`) torna-se desnecessária projeto a projeto, podendo ser instalada **globalmente**. Aqui vai a sequência de passos – realizadas numa máquina com Ubuntu – que demonstra como isso é possível:

1. Faça download do arquivo [https://getcomposer.org/composer.phar](https://getcomposer.org/composer.phar).

   ```sh
   $ wget https://getcomposer.org/composer.phar
   ```

2. Instale o Composer como dependência global com o próprio Composer.

   ```sh
   $ php composer.phar global require --dev composer/composer
   ```

3. Adicione o diretório global de binários à variável PATH. No Ubuntu, isso pode ser feito adicionando a seguinte linha ao arquivo `~/.bashrc`

   ```
   export PATH=&quot;$HOME/.composer/vendor/bin:$PATH&quot;
   ```

4. Remova o arquivo PHAR – não é mais necessário.

   ```sh
   $ rm composer.phar
   ```

Pronto. O comando `composer` já está disponível, mas sem o comando `self-update` embutido. Para atualizá-lo (junto com outros binários instalados), basta executar:

```sh
$ composer global update
```
</content:encoded></item><item><title><![CDATA[Como instalar e usar o Composer?]]></title><description><![CDATA[Em projetos PHP atuais, é praticamente impossível um desenvolvedor fazer tudo do zero. Sempre existe um framework, uma library (biblioteca…]]></description><link>https://tassoevan.me/2015-06-06/como-instalar-e-usar-o-composer/</link><guid isPermaLink="false">https://tassoevan.me/2015-06-06/como-instalar-e-usar-o-composer/</guid><pubDate>Sat, 06 Jun 2015 05:30:00 GMT</pubDate><content:encoded>
Em projetos PHP atuais, é praticamente impossível um desenvolvedor fazer tudo do zero. Sempre existe um framework, uma library (biblioteca de código) ou até uma &quot;funçãozinha&quot; que outros devs escreveram e que nós utilizamos para entregar tudo dentro de prazos.

Alguns exemplos? [Laravel](http://laravel.com/), [Zend Framework](http://framework.zend.com/), [Yii](http://www.yiiframework.com/), [Symfony](https://symfony.com/), [Climate](http://climate.thephpleague.com/) etc.

Cada vez que utilizamos algo do tipo, estamos gerando uma _dependência_ no projeto. Para que a nossa aplicação funcione, todas as dependências devem _ser resolvidas_, isto é, o código delas deve estar acessível.

# O que é?

O [Composer](https://getcomposer.org/) é um _gerenciador de dependências_ escrito em e escrito para PHP. Através dele, todas as dependências de um projeto são baixadas da Internet automaticamente na forma de _pacotes_ e corretamente disponibilizadas num diretório. Inclusive com direito a autoloader.

# Como instalar?

O Composer é disponibilizado como um arquivo PHAR (PHP archive) simples, mas para evitar múltiplas cópias dele espalhadas por aí, o ideal é instalá-lo globalmente.

## Debian/Ubuntu/Linux Mint

Se a ferramenta de linha de comando do PHP não está instalada,

```sh
$ sudo apt-get install php5-cli
```

Então instalar é fácil como digitar no terminal isto:

```
$ php -r &quot;readfile(&apos;https://getcomposer.org/installer&apos;);&quot; | sudo php -- --install-dir=/usr/bin --filename=composer
```

Para mais detalhes, consulte: [http://getcomposer.org/doc/00-intro.md#installation-nix](http://getcomposer.org/doc/00-intro.md#installation-nix)

## Windows

Baixe e execute o [instalador oficial](https://getcomposer.org/Composer-Setup.exe).

Para mais detalhes, consulte: [http://getcomposer.org/doc/00-intro.md#installation-windows](http://getcomposer.org/doc/00-intro.md#installation-windows)

# Como descrevar as dependências?

Para começar, você precisa descrever quais são as dependências do seu projeto em algum lugar. Isso é feito no arquivo `composer.json`, que agora também deve fazer parte do seu código. Como a extensão sugere, ele deve ter um conteúdo JSON válido. Vamos começar com um arquivo simples:

```json
{
  &quot;name&quot;: &quot;minha-empresa/meu-projeto&quot;,
  &quot;description&quot;: &quot;Meu primeiro projeto com Composer&quot;,
  &quot;license&quot;: &quot;proprietary&quot;
}
```

Os itens `name` e `description` são obrigatórios e `license` é recomendado. Você pode verificar se tudo está ok executando o comando:

```sh
$ composer validate
./composer.json is valid
```

Agora podemos adicionar algumas dependências.

```json
{
  &quot;name&quot;: &quot;minha-empresa/meu-projeto&quot;,
  &quot;description&quot;: &quot;Meu primeiro projeto com Composer&quot;,
  &quot;license&quot;: &quot;proprietary&quot;,
  &quot;require&quot;: {
    &quot;yiisoft/yii2&quot;: &quot;~2.0.0&quot;
  }
}
```

Dentro da propriedade `require`, eu defini que meu projeto tem como dependência o framework Yii.

**Por que ele está descrito como `yiisoft/yii2`?** Porque foi assim que a Yiisoft o registrou no [Packagist](https://packagist.org/packages/yiisoft/yii2), o principal repositório de pacotes do Composer.

**O que significa `~2.0.0`?** Estamos especificando que queremos qualquer pacote cuja versão seja igual ou superior a 2.0.0 e inferior a 2.1.0. Existem várias [formas de descrever as versões](https://getcomposer.org/doc/02-libraries.md#specifying-the-version) que precisamos. As recomendações principais são (1) evitar as versões `dev-master`, que são baseadas no último código escrito nos pacotes e, portanto, mutáveis; e (2) evitar a tentação de utilizar `*` para ter sempre a última versão disponível. Existe uma diferença enorme, por exemplo, entre a versão 1.1 e a versão 2.0 do Yii. Atualizar dependências assim significa conviver com o fato de ter que mudar todo seu código quando uma delas for atualizada.

# Enfim, como utilizar?

Com tudo isso feito, estamos a um mero passo de ter o Yii no nosso projeto:

```sh
$ composer install
```

O Composer vai verificar os repositórios, como o Packagist; verificar se possuem os pacotes necessários; baixá-los; adicioná-los ao diretório `vendor` do projeto; e criar um arquivo `composer.lock`, que é uma versão superdetalhada do `composer.json`, descrevendo até todas as subdepências (i.e., as dependências das dependências do projeto) e versões baixadas.

Pronto.

Para atualizar as dependências ou reinstalá-las, utilize:

```sh
$ composer update
```
</content:encoded></item><item><title><![CDATA[Git para times de todos os tamanhos]]></title><description><![CDATA[Recentemente, o  sugerindo um workflow baseado no conhecido  de Vincent Driessen. Gostei das sugestões dadas e…]]></description><link>https://tassoevan.me/2014-12-03/git-para-times-de-todos-os-tamanhos/</link><guid isPermaLink="false">https://tassoevan.me/2014-12-03/git-para-times-de-todos-os-tamanhos/</guid><pubDate>Thu, 04 Dec 2014 06:30:00 GMT</pubDate><content:encoded>
Recentemente, o &lt;a href=&quot;http://code.tutsplus.com/tutorials/focusing-on-a-team-workflow-with-git--cms-22514&quot; target=&quot;_blank&quot; title=&quot;Focusing on a Team Workflow With Git&quot;&gt;Tuts+ lançou um artigo&lt;/a&gt; sugerindo um _workflow_ baseado no conhecido &lt;a href=&quot;http://nvie.com/posts/a-successful-git-branching-model/&quot; target=&quot;_blank&quot; title=&quot;A successful Git branching model&quot;&gt;Git-Flow&lt;/a&gt; de Vincent Driessen. Gostei das sugestões dadas e resolvi escrever um pouco sobre esse assunto adicionando uma pitada da minha experiência com o uso de git em pequenas equipes.

# Preciso disso?

Uma vez que superamos as primeiras barreiras de aprendizado e dominamos os conceitos que o git nos traz, como submissões (_commits_), ramos (_branches_), repositórios etc., já somos capazes de dominar com relativa facilidade a administração dos nossos próprios repositórios. Entretanto, mesmo nessa situação de controle total, em alguns momentos decidir entre se fazer do jeito A ou fazer do jeito B é melhor. Acredito que esse sentimento está presente quando percorremos o log de commits de um repositório e não encontramos em qual o commit uma determinada modificação foi feita. Quando isso ocorre, notamos pela primeira vez que mensagens de commit devem ser bem escritas para nós mesmos, não apenas para escrevermos um _change log_ pomposo que nem precisamos manter em alguns casos. **Mas o que seria uma mensagem de commit bem escrita?**

Se esse pequeno problema já é bem incômodo quando trabalhamos sozinhos, imagina o quão crítico ele se torna onde estamos trabalhando em equipe, seja num projeto com colegas de trabalho ou num projeto open source hospedado no GitHub ou outro serviço popular. O que toda ferramenta de controle de versão se propõe a fazer é garantir que, quando vários colaboradores fazem modificações sobre os mesmos arquivos, os conflitos gerados sejam detectados e resolvidos antes de que as mudanças sejam aceitas, e o git trata desses conflitos de uma forma muito conveniente. Segundo seus usuários, muito superior à forma como as demais ferramentas (SourceSafe, CVS, SVN) trabalham. **O que não significa, todavia, que o git resolva os conflitos sozinho.** Há sempre uma etapa no processo de trabalho em equipe em que o código deve ser revisado e aceito por alguém. Nessa situação, gerenciar vários commits em conflito pode ser algo muito desafiador se não houver uma ordem de trabalho, mesmo em projetos pequenos. Código mal revisado significa adição de bugs no seu software.

Agora vou citar uma série de regras que são interessantes para o gerenciamento dos repositórios git. São **sugestões**: você pode adicionar, remover ou modificar algumas propostas para que se ajustem ao ritmo de trabalho da sua equipe. E o seu também.

# Quais são as regras do jogo?

1. [`master` é a versão estável](#regra-1)
2. [`develop` é a versão instável](#regra-2)
3. [`feature-&lt;funcionalidade&gt;` é uma funcionalidade nova](#regra-3)
4. [`fix-&lt;problema&gt;` é a correção de um problema](#regra-4)
5. [`hotfix-&lt;problema&gt;` é a correção de um problema no código em `master`](#regra-5)
6. [`&lt;funcionalidade&gt;` e `&lt;problema&gt;` são códigos simples](#regra-6)
7. [Resolva os conflitos com o branch `develop` antes de solicitar uma mesclagem](#regra-7)
8. [Enviou os commits antes de resolver os conflitos? Mescle `develop`](#regra-8)
9. [O revisor de código deve informar as mesclagens em `develop` e `master`](#regra-9)
10. [Adicione tags aos commits de mesclagem em `master`](#regra-10)
11. [Use verbos imperativos nas mensagens dos commits](#regra-11)
12. [Frase curta + descrição longa](#regra-12)

&lt;a name=&apos;regra-1&apos;&gt;&lt;/a&gt;

## Regra #1 - `master` é a versão estável

[Ian Lollar](https://twitter.com/redhotvengeance), o autor do artigo do Tuts+, estabelece essa regra como a principal. Eu concordo totalmente com ele.

Quando alguém clona um repositório, sempre se espera que o código do repositório já está &quot;pronto para uso&quot; (_deployable_). Se for código compilável, ele pode ser compilado em poucos comandos para gerar um programa estável; se for o código de um website, ele já pode ser enviado para o servidor.

Para quem está acostumado com os ambientes de _desenvolvimento_, de _homologação_ e de _produção_, o branch `master` deve conter o código de produção. Quando algum problema sério ocorre em software em produção, nós temos que agir para enviar correções imediatas (_hotfixes_) sobre esse código. Afinal, como você vai escrever um hotfix em cima do código que está em desenvolvimento e contém modificações que ainda estão incompletas ou não foram aprovadas para produção?

&lt;a name=&apos;regra-2&apos;&gt;&lt;/a&gt;

## Regra #2 - `develop` é a versão instável

Entenda-se que a versão instável de um software é aquela que ainda está incompleta ou não foi aprovada para produção. _Incompleta_, nesse sentido, significa que ainda não contém todas as funcionalidades que estão planejadas para virar a versão estável e **não quer dizer é possui funcionalidades incompletas**. Para entender o que é isso, suponha que você está desenvolvendo uma aplicação divida em vários módulos. Cada módulo criado representa uma funcionalidade nova adicionada ao sistema. Logo, cada módulo pronto deve ser adiciona ao branch `develop`, mas isso não significa que o módulo todo seja empacotado num único commit. Se algum módulo é constituído de várias telas, cada tela pode ser enviada ao repositório como um commit diferente, **mas não diretamente ao branch `develop`**.

Mantenha isso em mente quando trabalhar com o branch `develop`: ele só deve aceitar funcionalidades **completas**.

&lt;a name=&apos;regra-3&apos;&gt;&lt;/a&gt;

## Regra #3 - `feature-&lt;funcionalidade&gt;` é uma funcionalidade nova

Em outras palavras, cada coisa nova que você adiciona ao seu software deve ser gradualmente commitada num branch específico. O prefixo `feature-` no nome do branch indica que ele contém uma funcionalidade (_feature_). Uma vez que a funcionalidade está completa e nenhum novo commit for adicionado a esse branch, você pode enviar uma solicitação ao revisor de código do projeto pedindo que ele mescle (_merge_) os commits no branch `develop`.

&lt;a name=&apos;regra-4&apos;&gt;&lt;/a&gt;

## Regra #4 - `fix-&lt;problema&gt;` é a correção de um problema

Quando um problema é conhecido num projeto e ele não é solucionado pela adição de uma funcionalidade nova &amp;mdash; logo, um bug &amp;mdash;, uma correção deve ser enviada para o código presente no branch `develop`, mas nunca diretamente. Novamente, assim que o código estiver completo no branch, você solicita uma mesclagem.

&lt;a name=&apos;regra-5&apos;&gt;&lt;/a&gt;

## Regra #5 - `hotfix-&lt;problema&gt;` é a correção de um problema no código em `master`

Enquanto os dois tipos de branches anteriormente citados são criados a partir de `develop`,

```sh
$ git checkout -b `feature-&lt;funcionalidade&gt;` `develop`
```

este tipo especial de branch precisa ser criado a partir do código de produção, presente em `master`:

```sh
$ git checkout -b `hotfix-&lt;problema&gt;` `master`
```

&lt;a name=&apos;regra-6&apos;&gt;&lt;/a&gt;

## Regra #6 - `&lt;funcionalidade&gt;` e `&lt;problema&gt;` são códigos simples

Complementando as três regras anteriores, é preciso deixar claro que descrever o nome de uma funcionalidade ou de um problema pode ser uma tarefa complicada. Quando a equipe tem acesso a algum gerenciador de incidentes (_issue tracker_), por exemplo, os bugs são numerados, de forma que os branches são melhor descritos na forma `fix-issue-X`, onde X é o número do bug.

Alguns exemplos adicionais de branches seriam `feature-modulo-usuarios`, `fix-bug-323`, `feature-pagina-sobre`, `hotfix-issue-23` etc. Tenha em mente que isso deve ser acordado entre todos os membros da equipe, não apenas de ciência do revisor de código.

&lt;a name=&apos;regra-7&apos;&gt;&lt;/a&gt;

## Regra #7 - Resolva os conflitos com o branch `develop` antes de solicitar uma mesclagem

Suponha que você e um colega desejam criar duas funcionalidades diferentes, A e B. Você vai ficar com a funcionalidade A e, portanto, criará um branch chamado `feature-A` no seu repositório local. Seu colega criará um branch `feature-B` no repositório dele. Vocês seguem trabalhando, mas seu colega termina o trabalho antes e solicita uma mesclagem em seguida para o revisor de código. O revisor verifica que está tudo certo e mescla os commits do branch `feature-B` no branch `develop` do repositório principal. Você termina o seu trabalho e solicita uma mesclagem. O revisor de código então descobre um conflito, pois o seu colega alterou algum ponto no projeto que você também alterou no desenvolvimento das funcionaldades. Assim, você precisa adicionar ao seu próprio branch `feature-A` os commits de `feature-B` que foram adicionados em `develop`. A melhor forma de fazer isso é através de _rebasing_.

Rebasing é uma técnica do git que consiste em reescrever os commits de um branch, reordenando-os, adicionando novos, removendo alguns e até mesmo reescrevendo o código armazenado em certos commits. No caso apresentado, realizar rebase do branch `develop` no branch `feature-A` vai implicar em ter que reescrever algum commit que você adicionou no `feature-A`.

O ideal é que o branch `develop` do seu repositório local esteja sempre atualizado com relação ao `develop` do repositório principal:

```sh
$ git checkout develop
$ git pull origin develop
```

Em seguida, você pode adicionar as mudanças de `develop` no seu branch:

```sh
$ git checkout feature-A
$ git rebase develop
```

E seguir trabalhando na funcionalidade. Quando tudo estiver pronto:

```sh
$ git push origin feature-A
```

&lt;a name=&apos;regra-8&apos;&gt;&lt;/a&gt;

## Regra #8 - Enviou os commits antes de resolver os conflitos? Mescle `develop`

É possível que você acidentalmente envie para o repositório principal o branch de trabalho sem se certificar de que ele não tem conflitos em relação ao `develop`. Se esses conflitos existem, o revisor de código te informará disso e caberá a você resolver. Como **você nunca deve reescrever o que já está no repositório principal**, rebasing não poderá ser utilizado aqui. Como Lollar diz, rebasing é uma ação destrutiva. Você precisa criar um commit novo que solucione os conflitos; é exatamente o que o comando `git merge` te permite fazer:

```sh
$ git checkout feature-A
$ git merge develop
```

Uma forma simplificada de resolver os conflitos é através do comando `git mergetool`. Com ele, cada conflito existente é listado e as devidas ações de correção são pedidas para você, uma a uma.

&lt;a name=&apos;regra-9&apos;&gt;&lt;/a&gt;

## Regra #9 - O revisor de código deve informar as mesclagens em `develop` e `master`

E como ele pode dizer que os commits adicionados em `develop` vieram de `feature-A`? Desabilitando o recurso de &lt;a href=&quot;http://ariya.ofilabs.com/2013/09/fast-forward-git-merge.html&quot; target=&quot;_blank&quot; title=&quot;Fast-Forward Git Merge&quot;&gt; _fast-forwarding_ &lt;/a&gt; na mesclagem.

```sh
$ git checkout develop
$ git merge --no-ff feature-A
```

Isto adicionará um commit adicional a `develop` informando a mesclagem, em vez de copiar os commits de `feature-A` em `develop`.

E qual a vantagem de se fazer isso?

&lt;a name=&apos;regra-10&apos;&gt;&lt;/a&gt;

## Regra #10 - Adicione tags aos commits de mesclagem em `master`

As tags permitem que você marque pontos importantes no histórico do código presente no `master`, como mudanças de versão.

```sh
$ git checkout master
$ git merge --no-ff develop
$ git tag -a v&lt;versão&gt; -m &apos;Versão &lt;versão&gt;&apos;
```

Uma dica adicional, também sugerida por Lollar, é a utilização do &lt;a href=&quot;http://semver.org/&quot; target=&quot;_blank&quot; title=&quot;Semantic Versioning 2.0.0&quot;&gt;versionamento semântico&lt;/a&gt; para escrever os números de versões.

&lt;a name=&apos;regra-11&apos;&gt;&lt;/a&gt;

## Regra #11 - Use verbos imperativos nas mensagens dos commits

&quot;**Adiciona** a tela X&quot; em vez de &quot;Tela X adicionada&quot;. &quot;**Corrige** o bug Y&quot; em vez de &quot;Correção do bug Y&quot;. Alguns verbos comuns:

- adiciona
- remove
- corrige
- transfere
- atualiza

Pode &quot;colar&quot; alguns verbos de &lt;a href=&quot;http://www.youtube.com/watch?v=YtdWHFwmd2o&quot; target=&quot;_blank&quot; title=&quot;Daft Punk - Technologic&quot;&gt;_Technologic_&lt;/a&gt; também.

&lt;a name=&apos;regra-12&apos;&gt;&lt;/a&gt;

## Regra #12 - Frase curta + descrição longa

Outra recomendação é que a mensagem do commit seja uma frase curta (de até 50 caracteres, com a primeira letra maiúscula), uma linha em branco e um parágrafo que dê uma descrição maior sobre o commit. Essa descrição, entretanto, é opcional.
</content:encoded></item><item><title><![CDATA[Adeus shell_exec()]]></title><description><![CDATA[Como converter um PDF em imagens PNG ou JPEG, usando PHP? Como converter arquivos de vídeo enviados via upload em formatos para a web, como…]]></description><link>https://tassoevan.me/2014-10-16/symfony-process/</link><guid isPermaLink="false">https://tassoevan.me/2014-10-16/symfony-process/</guid><pubDate>Fri, 17 Oct 2014 06:00:00 GMT</pubDate><content:encoded>
Como [converter um PDF em imagens PNG ou JPEG](http://stackoverflow.com/questions/13600598/convert-pdf-to-jpg-image-with-php), _usando PHP_? Como [converter arquivos de vídeo enviados via upload em formatos para a web](http://stackoverflow.com/questions/1571134/how-can-i-convert-an-avi-file-to-flv-format-with-php), como WebM ou FLV, _usando PHP_? Como realizar uma tarefa administrativa no servidor, _usando PHP_?

Muitas vezes nos fazemos essas perguntas e passamos por algumas decepções ao procurar soluções. A primeira é descobrir que nem sempre podemos resolver usando única e exclusivamente a linguagem e/ou tecnologia que usamos em nossos projetos: PHP não foi construída para executar tarefas longas e que demandam alto processamento, como converter formatos de imagem, áudio e vídeo. Até podemos considerar o uso de extensões (como a [ImageMagick](http://php.net/manual/en/book.imagick.php)), mas geralmente o modo rápido de conseguir o que se quer é através de **programas externos**, como `avconv` e `convert`.

A principal dificuldade esperada ao realizar a integração entre scripts PHP e programas externos é a perda de compatibilidade nas diversas plataformas em que PHP é executável. A maioria dos exemplos de uso das funções `exec()`, `shell_exec()` e `passthru()` utiliza programas do ecossistema Unix e, ao menos no Brasil, o número de desenvolvedores PHP que rodam Windows em suas estações de trabalho é grande. Para eles, usar programas externos é adicionar ao seu código algo que só poderá ser testado em servidores de teste ou desenvolvimento &amp;mdash; uma realidade que vem mudando, a passos de formiga, com a adoção de ferramentas como [Vagrant](http://www.vagrantup.com/) e [Docker](http://www.docker.com/).

Então é simples usar programas externos? Não. Todo programa é executado como um novo **processo** do sistema, chamado pelo **shell** através de uma **linha de comando**. E neste contexto, existem algumas coisas a se considerar:

1. Deve ser garantido que nenhum número abusivo de processos seja executado;
2. Deve ser garantido que [nenhum dado enviado execute código arbitrário](http://en.wikipedia.org/wiki/Code_injection#Shell_injection);
3. Todo processo possui uma [stream de entrada de dados](http://en.wikipedia.org/wiki/Standard_streams#Standard_input_.28stdin.29), uma [stream de saída normal](http://en.wikipedia.org/wiki/Standard_streams#Standard_output_.28stdout.29) e uma [stream de saída de erros](http://en.wikipedia.org/wiki/Standard_streams#Standard_error_.28stderr.29);
4. Alguns processos exigem interação do usuário através da stream de entrada;
5. Alguns processos são longos;
6. Alguns processos escrevem dados em formatos complexos nas streams de saída;
7. Processos retornam um [código de status de fim de execução](http://en.wikipedia.org/wiki/Exit_status) que indica erros ocorridos durante a execução.

Vamos ver que opções as funções padrão do PHP nos fornecem para trabalhar com processos:

# [`string shell_exec(string $cmd)`](http://php.net/manual/en/function.shell-exec.php) ou [`` `$cmd` ``](http://php.net/manual/en/language.operators.execution.php)

É a função ideal para processos invocados com uma linha de comando simples e que escrevem apenas uma linha de texto na stream de saída.

1. Somente um processo pode ser executado por vez, a menos que se utilizem mecanismos de execução paralela presentes no shell (e.g. `start convert doc.pdf images.jpg` em Windows).
2. Você depende de `escapeshellarg($arg)` para escapar argumentos vindos da entrada de usuário. Usar ou não usar é por sua conta e risco. Para o operador de execução (`` ` ` ``) é impossível passar dados de usuário, como se a definição da linha de comando do processo fosse constante.
3. Tudo o que foi escrito na stream de saída é retornado pela função. Em caso de erro, entretanto, é retornado o valor `NULL`, mesmo que dados tenham sido escritos.
4. Não permite escrever dados na stream de entrada.
5. Você não pode definir um tempo máximo para a execução do processo, embora fique limitado pelo limite de tempo de execução do próprio script PHP.
6. Você precisa parsear toda a stream de saída obtida através do retorno da função/expressão.
7. Você não obtém o código de status. Se ele for zero, a função retorna o conteúdo da stream de saída; caso contrário, `NULL` é retornado.

# [`string exec(string $command[, array &amp;$output[, int &amp;$return_var]])`](http://php.net/manual/en/function.exec.php)

Esta função adiciona um grau maior de controle sob o que é escrito na stream de saída e sobre os códigos de status.

1. Somente um processo pode ser executado por vez, a menos que se utilizem mecanismos de execução paralela presentes no shell.
2. Você depende de `escapeshellarg($arg)` para escapar argumentos vindos da entrada de usuário. Usar ou não usar é por sua conta e risco.
3. Você pode ter acesso ao que foi escrito na stream de saída através do array `$output` ou apenas da última linha escrita através do retorno da função.
4. Não permite escrever dados na stream de entrada.
5. Você não pode definir um tempo máximo para a execução do processo, embora fique limitado pelo limite de tempo de execução do próprio script PHP.
6. Você precisa parsear toda a stream de saída obtida através de `$output`.
7. Você obtém o código de status através de `$return_var`.

# [`void passthru(string $command[, int &amp;$return_var])`](http://php.net/manual/en/function.passthru.php)

O uso mais comum desta função é quando o script PHP funciona como um simples proxy para um programa externo, como um gerador de imagens ou compilador.

1. Somente um processo pode ser executado por vez, a menos que se utilizem mecanismos de execução paralela presentes no shell.
2. Você depende de `escapeshellarg($arg)` para escapar argumentos vindos da entrada de usuário. Usar ou não usar é por sua conta e risco.
3. A stream de saída do processo é redirecionada para a stream de saída do script PHP. Se você quiser capturar a saída, vai ter que utilizar mecanismos de _output buffering_ (`ob_start()`).
4. Não permite escrever dados na stream de entrada.
5. Você não pode definir um tempo máximo para a execução do processo, embora fique limitado pelo limite de tempo de execução do próprio script PHP.
6. Você precisa parsear toda a stream de saída obtida através de _output buffering_.
7. Você obtém o código de status através de `$return_var`.

# [`resource proc_open(string $cmd, array $descriptorspec, array &amp;$pipes[, string $cwd[, array $env[, array $other_options]]])`](php.net/manual/en/function.proc-open.php)

E aqui temos o maior controle possível de processos (inclusive do diretório de trabalho do processo, via `$cwd`) através de scripts PHP.

1. Esta função é não-bloqueante, de modo que você pode iniciar quantos processos julgar adequado. Vale o bom senso para garantir que uma quantidade não-abusiva de processos sejam rodados paralelamente.
2. Você depende de `escapeshellarg($arg)` para escapar argumentos vindos da entrada de usuário. Usar ou não usar é por sua conta e risco.
3. Você tem acesso a _stdin_, _stdout_ e _stderr_ através do array `$pipes`, como se fossem ponteiros de arquivo tradicionais.
4. _stdin_ é uma stream de escrita, onde você pode escrever usando funções simples como `fwrite()`.
5. O controle de _timeout_ dos processos pode ser implementado, já que o processo roda paralelamente ao script.
6. A leitura dos dados escritos em _stdout_ e _stderr_ não difere da leitura de um arquivo; assim, as mesmas técnicas empregadas para parsear um arquivo podem ser aplicadas, seja de forma integral (ler toda a stream e interpretar o formato), seja de forma contínua (ler a stream linha a linha e interpretar durante a execução).
7. Você pode ter o código de status a partir do retorno de `proc_close($process)`.

# Tudo é complicado

Pelo que se percebe, a complexidade para se executar certos processos via PHP é semelhante à própria complexidade do processo, i.e., um processo que exige interação com todas as streams, _timeout_ e controle do código de status vai demandar o uso de uma função muito complexa. [Veja você mesmo](http://php.net/manual/en/function.proc-open.php#example-3774):

```php
&lt;?php
$descriptorspec = array(
   0 =&gt; array(&quot;pipe&quot;, &quot;r&quot;),  // stdin is a pipe that the child will read from
   1 =&gt; array(&quot;pipe&quot;, &quot;w&quot;),  // stdout is a pipe that the child will write to
   2 =&gt; array(&quot;file&quot;, &quot;/tmp/error-output.txt&quot;, &quot;a&quot;) // stderr is a file to write to
);

$cwd = &apos;/tmp&apos;;
$env = array(&apos;some_option&apos; =&gt; &apos;aeiou&apos;);

$process = proc_open(&apos;php&apos;, $descriptorspec, $pipes, $cwd, $env);

if (is_resource($process)) {
    // $pipes now looks like this:
    // 0 =&gt; writeable handle connected to child stdin
    // 1 =&gt; readable handle connected to child stdout
    // Any error output will be appended to /tmp/error-output.txt

    fwrite($pipes[0], &apos;&lt;?php print_r($_ENV); ?&gt;&apos;);
    fclose($pipes[0]);

    echo stream_get_contents($pipes[1]);
    fclose($pipes[1]);

    // It is important that you close any pipes before calling
    // proc_close in order to avoid a deadlock
    $return_value = proc_close($process);

    echo &quot;command returned $return_value\n&quot;;
}
```

Nesse exemplo, abrimos o processo `php`, escrevemos na stream de entrada o código `&lt;?php print_r($_ENV); ?&gt;` e lemos o resultado da execução na stream de saída do processo. Nenhum mecanismo de _timeout_ é implementado, bem como nenhum controle de erros é realizado através da stream de erros e do código de status, e mesmo assim temos um código assustador para programadores novatos.

## Symfony Process ao resgate

Streams, código de status, _timeout_, diretório de trabalho, argumentos escapados... Muitos são os componentes e detalhes presentes na execução de um processo. Para nossa sorte, o componente [Symfony Process](http://symfony.com/doc/current/components/process.html) provê um mecanismo simples para execução e controle de processos (e ao contrário do que muitos pensam **não é necessário estar utilizando o framework Symfony para usufruir deste componente**). Vamos recriar o exemplo supracitado para demonstrar isso.

Primeiramente, você pode baixar as classes do Symfony Process de modo tradicional, mas isso é desaconselhado; prefira fazer o controle deste e de demais códigos de terceiros através do [Composer](https://getcomposer.org), um gerenciador de dependências para PHP que se tornou praticamente o padrão da indústria. Caso você ainda não esteja utilizando no seu projeto, execute no terminal

```sh
$ composer init
```

E forneça informações básicas do seu projeto. Assim que o arquivo `composer.json` estiver disponível, execute

```sh
$ composer require symfony/process
```

Para adicionar ao seu projeto a última versão do componente Symfony Process. Todo o código fica disponível no diretório `vendor/symfony/process` e o arquivo `composer.lock` é criado para registrar qual a versão utilizada.

Com a library em mãos, vamos recriar o exemplo passo-a-passo. Escreva, num arquivo chamado `exemplo.php`, as seguintes linhas:

```php
&lt;?php
require __DIR__.&apos;/vendor/autoload.php&apos;;

use Symfony\Component\Process\Process;
```

A primeira linha vai adicionar o autoloader do Composer, tornando acessíveis todas as classes do Symfony Process. A linha seguinte permite que a classe `Symfony\Component\Process\Process` possa ser chamada apenas de `Process` no script. Ainda no mesmo arquivo, escreva:

```php
$process = new Process(&apos;php&apos;);
```

Essa linha não executa o processo `php` de imediato, apenas prepara uma instância da classe `Process` que representa um processo antes, durante, e após sua execução.

```php
$process-&gt;setInput(&apos;&lt;?php print_r($_ENV); ?&gt;&apos;);
```

Aqui foi definido qual conteúdo será escrito em _stdin_ que o processo seja executado (esse método lança `RuntimeException` se é executado depois que o processo é executado).

```php
$process-&gt;run(function ($type, $buffer) {
    if (Process::ERR === $type) {
        echo &apos;ERR &gt; &apos;.$buffer;
    } else {
        echo &apos;OUT &gt; &apos;.$buffer;
    }
});
```

Aqui o processo é executado de fato, de forma síncrona (para executar o processo de forma asíncrona, `$process-&gt;start()` deve ser invocado no lugar de `$process-&gt;run()`), mas com um adendo: toda saída gerada pelo processo, em _stdout_ e _stderr_, é passada imediatamente para o callable passado como parâmetro do método `run()` (neste caso, é uma closure). O callable deve aceitar dois parâmetros: `$type`, que indica se a saída foi escrita em _stdout_ ou _stderr_; `$buffer`, que contém o texto escrito.

E... Isso é tudo. Você não precisa fechar o processo, muito menos pará-lo. Segue o exemplo completo:

```php
&lt;?php
require __DIR__.&apos;/vendor/autoload.php&apos;;

use Symfony\Component\Process\Process;

$process = new Process(&apos;php&apos;);
$process-&gt;setInput(&apos;&lt;?php print_r($_ENV); ?&gt;&apos;);
$process-&gt;run(function ($type, $buffer) {
    if (Process::ERR === $type) {
        echo &apos;ERR &gt; &apos;.$buffer;
    } else {
        echo &apos;OUT &gt; &apos;.$buffer;
    }
});

```

### Agora vá!

Espero que este artigo tenha instigado o leitor investir um pouco de atenção ao componente Symfony Process. As possibilidades com ele são interessantes, principalmente se o seu desejo for de adicionar poder de fogo à sua aplicação web. Em breve devo demonstrar mais casos de uso, como invocação de `convert`, `avconv` e `rsync`. Até lá!
</content:encoded></item><item><title><![CDATA[Contagem regressiva para a Web.br 2014!]]></title><description><![CDATA[Recentemente desenvolvi um trabalho interessante no projeto Atlas Digital da Economia Solidária da Alligo para o Grupo Ecosol (Grupo de…]]></description><link>https://tassoevan.me/2014-09-23/webbr/</link><guid isPermaLink="false">https://tassoevan.me/2014-09-23/webbr/</guid><pubDate>Tue, 23 Sep 2014 11:00:00 GMT</pubDate><content:encoded>
Recentemente desenvolvi um trabalho interessante no projeto
[Atlas Digital da Economia Solidária](http://atlas.sies.org.br/) da [Alligo](http://alligo.com.br) para o
[Grupo Ecosol (Grupo de Pesquisa em Economia Solidária)](http://blogecosol.wordpress.com/) como parte do
[Projeto SIES](http://sies.ecosol.org.br/) que envolveu a aplicação de alguns princípios de interoperabilidade, uma vez
que o front-end da aplicação é alimento por um web service que mantém uma API RESTful. Eis vou palestrar sobre este e
outros assuntos com o líder do projeto, [Emerson Rocha Luiz](http://www.fititnt.org/), na
[Web.br 2014 Conferência Web W3C Brasil](http://conferenciaweb.w3c.br/) nesta quinta-feira, dia 25. Este ano
a conferência carrega uma comemoração especial: os [25 anos da Web](http://www.webat25.org/) e os [20 anos do W3C](http://www.w3.org/).

Alguns pontos que procurarei abordar incluem REST, HATEOAS, Web Semântica, JSON-LD e linked data em geral. O
Emerson vai descrever o que espera-se de atlas temáticos digitais e o que realmente é entregue, bem como o uso de dados
abertos em aplicações contruídas sobre a Open Web Platform e alguns tópicos especiais de acessibilidade e usabilidade.
</content:encoded></item><item><title><![CDATA[Higiene e segurança em escritórios de TI]]></title><description><![CDATA[O presente trabalho foi motivado pela promoção de diversas campanhas, como a prompt, sobre o impacto de atividades na indústria de…]]></description><link>https://tassoevan.me/2014-07-21/higiene-e-seguranca-em-escritorios-de-ti/</link><guid isPermaLink="false">https://tassoevan.me/2014-07-21/higiene-e-seguranca-em-escritorios-de-ti/</guid><pubDate>Mon, 21 Jul 2014 17:00:00 GMT</pubDate><content:encoded>
# Introdução

O presente trabalho foi motivado pela promoção de diversas campanhas, como a [prompt](http://prompt.engineyard.com/), sobre o impacto de atividades na indústria de tecnologia da informação tem sobre a saúde mental dos trabalhadores da área, e um [relatório recente](http://www.headsup.org.au:8080/docs/default-source/resources/beyondblue_workplaceroi_finalreport_may-2014.pdf?sfvrsn=2), financiado pelo governo da Austrália sobre o retorno sobre investimento (ROI) na manutenção de espaços de trabalho que promovem saúde mental.

# Descrição da empresa

Para o presente trabalho foi realizada a análise de uma empresa do setor de Tecnologia da Informação registrada na Junta Comercial do Estado do Rio Grande do Sul em abril de 2007 e com sede em Porto Alegre. Inicialmente, a empresa fornecia serviços em plataforma web através de convênio com seccionais da Ordem dos Advogados do Brasil e contato direto com escritórios de advocacia, mas atualmente está em expansão de escopo para atingir mais clientes que precisam de soluções empresariais em TI, ultrapassando a marca atual de 77 mil clientes em todo território brasileiro.

A empresa possui um quadro de 135 colaboradores que se dividem nos seguintes setores:

_Setor administrativo._ Abrange todas as atividades de controle financeiro e gestão de recursos humanos da empresa.

_Setor de Identidade Profissional._ Composto de poucos profissionais de relacionamento direto com o cliente e designers, é responsável pela criação de produtos de identidade visual para clientes externos e internos, como logotipos e papelaria.

_Central de Relacionamento._ O maior setor da empresa. Possui a estrutura de uma central de telemarketing e subdivide-se em núcleos de venda, pós-venda, suporte, cobrança, recuperação de contratos etc.

_Setor de Tecnologia da Informação._ Composto de coordenadorias de Arquitetura, Infraestrutura, Planejamento de Produto e Desenvolvimento, é estruturado como um departamento de TI típico, excetuando-se que não foi adotado o _sistema de acordo de banco de horas_ para distribuição da jornada de trabalho.

![Diagrama de distribuição dos colaboradores entre setores](./distribuicao-colaboradores.png)

O foco da análise apresentada será o Setor de Tecnologia da Informação.

## Jornada de trabalho

A fim de manter um regimento interno equivalente e com o mínimo de particularidades entre a Central de Relacionamento, que deve manter atividade constante no horário de atendimento, e o setor de Tecnologia da Informação, que não precisa de horários fixos mesmo em atividades de operação, foi estabelecido, mediante acordo, que cada colaborador poderia definir uma distribuição do trabalho ao longo das oito horas diárias que fosse o mais adequado. Assim, o período de atividade é de 7h20 às 19h20, respeitando os intervalos obrigatórios previstos em lei.

# Distribuição de colaboradores no setor avaliado

As atividades realizadas pelos colaboradores são dividas com base nas coordenadorias, de modo que existem profissionais nos cargos de:

- webdesigner: 4 colaboradores;
- programador de sistemas de informação: 10 colaboradores;
- administrador de banco de dados: 1 colaborador;
- suporte técnico: 2 colaboradores;
- administradores de sistemas: 3 colaboradores.

Cabe destacar que existem apenas duas mulheres no setor, ambas programadoras.

# Processo de produção avaliado

Embora quase todos os colaboradores do setor desenvolvam atividades de projeto e planejamento, serão avaliados os riscos para a atividade de _operação_, desenvolvida majoritariamente pelos webdesigners, programadores e administradores de sistemas. Esta atividade pode ter seu fluxo de trabalho resumido como receber requisições através de um sistema de rastreamento de incidentes (_incident ticket system_) alimentado pelos profissionais da Central de Relacionamento e atuar em regime de urgência em sistemas que já estão em ambiente de produção, isto é, sistemas informatizados que já estão sendo executados e sendo alimentados com dados de clientes. Incidentes típicos registrados incluem:

- indisponibilidade de servidores;
- dados corrompidos ou incorretos;
- correções na interface visual;
- dúvidas que o núcleo de suporte não pode esclarecer etc.

# Espaço de trabalho

![Esquema simplificado do setor](./setor-ti.png)

# Identificação dos riscos ambientais

A empresa não paga adicionais de insalubridade (NR-15) e periculosidade (NR-16). Há Comissão Interna de Prevenção de Acidentes (CIPA, NR-5), escolhida conjuntamente ao conselho de colaboradores e mantém com rigor o Programa de Controle Médico de Saúde Ocupacional (PCMSO, NR-7) e o Programa de Prevenção de Riscos Ambientais (PPRA, NR-9). E, embora não disponha de Serviços Especializados de Engenharia de Segurança e em Medicina do Trabalho (SESMT), foi recentemente contratada uma massoterapeuta com especialização em Fisioterapia Ocupacional. Entre as métricas de monitoramento de Recursos Humanos, foram adicionados indicadores de acidentes no trabalho e doenças ocupacionais, pois alguns colaboradores apontaram problemas de saúde relacionados ao sedentarismo, como estresse, hipertensão, obesidade e problemas do trato gastroinstestinal (o único registro de afastamento pela Previdência Social foi relacionado a úlcera gástrica).

Seguem os riscos identificados no setor.

## 1. Risco físico

- Causa: calor/frio
- Fonte: sistema de ar condicionado
- Consequência: doenças respiratórias, doença de Raynaud, síndrome de Sjögren (xerostomia e xeroftalmia)
- Medidas de controle coletivas: dimensionamento adequado dos ambientes condicionados, distribuição calculada dos condicionadores, limpeza periódica dos filtros, respeito à ABNT NBR 16401-2 (parâmetros de conforto térmico)
- Medidas de controle individuais: uso de roupas adequadas à estação do ano, distanciamento de regiões de circulação de ar condicionado
- Risco não controlado.

## 2. Risco físico

- Causa: radiação
- Fonte: monitores dos computadores
- Consequência: xeroftalmia, aceleração da degeneração macular relacionada à idade (ARMD), alteração no ritmo circadiano, queimadura da retina
- Medidas de controle coletivas: aferição periódica da radiação, substituição de equipamento defeituoso
- Medidas de controle individuais: distância mínima de 50cm entre os olhos e a tela, piscar constantemente (dado que o movimento é semi-autônomo)
- Risco controlado com aferição realizada por empresa terceirizada.

## 3. Risco biomecânico

- Causa: postura inadequada
- Fonte: posto de trabalho sentado
- Consequência: sedentarismo, lordose, cifose, estase sanguínea dos membros inferiores
- Medidas de controle coletivas: adoção de assentos com regulagem de altura do assento, altura do apoio de costas e altura dos apoios para os braços, ginástica laboral, massagem preventiva para lombalgia
- Medidas de controle individuais: postura correta, pausas regulares na jornada de trabalho
- Risco controlado com cadeiras adequadas e massoterapia.

## 4. Risco biomecânico

- Causa: posição inadequada para os punhos
- Fonte: uso de mouse e teclado
- Consequência: epicondilite lateral, tendinite, lesões por esforço repetitivo (LER) em geral
- Medidas de controle coletivas: disponibilização de equipamentos ergonômicos e apoios para os punhos
- Medidas de controle individuais: pausas regulares na jornada de trabalho, ginástica laboral, automatização de tarefas que exigem grande interação do usuário de computador
- Risco não controlado.

## 5. Risco psicossocial

- Causa: carga de trabalho excessiva
- Fonte: utilização do sistema de rastreamento de incidentes
- Consequência: estresse, esgotamento (_burnout_)
- Medidas de controle coletivas: treinamento adequado para utilização do sistema de rastreamento de incidentes, alteração do fluxo de trabalho nas atividades de operação
- Medidas de controle individuais: psicoterapia ocupacional regular
- Risco não controlado.

# Conclusão

Como uma empresa de médio porte, a analisada apresenta, além da conformidade com as Normas Regulamentadoras de Segurança do Trabalho, desejo de aumentar a produtividade garantindo um ambiente de higiene adequada e um ambiente que fornece conforto aos colaboradores. Enquanto a minimização de alguns riscos depende de grande investimento financeiro, boa parte deles exige apenas campanhas internas para conscientização dos colaboradores, que pode ser uma solução de curto-prazo. Para longo prazo, alguns processos burocráticos devem ser revistos.

# Referências

1. MINISTÉRIO DO TRABALHO E EMPREGOS. Site www.mte.gov.br – Inspeção do Trabalho – Legislação – Normas Regulamentadoras.
2. &quot;Health effects of lighting systems using light-emitting diodes (LEDs)&quot;, ATTIA, D., ANSES. Set/2011.
</content:encoded></item><item><title><![CDATA[A forma mais *@#$!* para habilitar conexões ao banco de dados Oracle no PHP5 rodando sobre o Ubuntu]]></title><description><![CDATA[Este artigo está disponível como um gist. Sinta-se livre para contribuir. Agradecimentos especiais para:

AJ ONeal Hsiao Siyuan

Faça o…]]></description><link>https://tassoevan.me/2014-04-10/a-forma-mais---para-habilitar-conexoes-ao-banco-de-dados-oracle-no-php5-rodando-sobre-o-ubuntu/</link><guid isPermaLink="false">https://tassoevan.me/2014-04-10/a-forma-mais---para-habilitar-conexoes-ao-banco-de-dados-oracle-no-php5-rodando-sobre-o-ubuntu/</guid><pubDate>Thu, 10 Apr 2014 15:29:52 GMT</pubDate><content:encoded>
Este artigo está disponível como [um gist](https://gist.github.com/tassoevan/10392954). Sinta-se livre para contribuir.

Agradecimentos especiais para:

- [AJ ONeal](https://twitter.com/coolaj86)
- [Hsiao Siyuan](http://hsiaosiyuan.com/wp/)

# Primeiro passo: Instalação do cliente Oracle

1.  Faça o download do Instant Client em [http://www.oracle.com/technetwork/indexes/downloads/index.html#database](http://www.oracle.com/technetwork/indexes/downloads/index.html#database) (você deve ter um usuário registrado no site da Oracle; o registro é gratuito). Você precisa dos arquivos `instantclient-basic-*-*.zip` e `instantclient-sdk-*-*.zip`.
2.  Execute os seguintes comandos no seu terminal:

        $ sudo su -
        $ mkdir -p /opt/oracle/instantclient
        $ cd /opt/oracle/instantclient

3.  Copie os arquivos baixados em `/opt/oracle/instantclient`.
4.  Descompacte os arquivos executando estes comandos:

        $ unzip instantclient-basic-*-*.zip
        $ unzip instantclient-sdk-*-*.zip

5.  Mova todos o conteúdo de `/opt/oracle/instantclient/instantclient` para `/opt/oracle/instantclient`:

        $ mv instantclient*/* ./
        $ rmdir instantclient*/

6.  Durante a compilação do código da extensão, alguns erros podem surgir quando forem resolvidas as dependências de algumas libraries. Para evitá-los, faça:

        $ ln -s libclntsh.so.* libclntsh.so
        $ ln -s libocci.so.* libocci.so
        $ echo /opt/oracle/instantclient &gt;&gt; /etc/ld.so.conf
        $ ldconfig

7.  Crie um diretório para seus arquivos de configuração de rede:

        $ mkdir -p network/admin

8.  Coloque os arquivos `sqlnet.ora` e `tnsnames.ora` em `/opt/oracle/instantclient/network/admin`.

Agora você tem o kit básico para conexões e acesso à SDK para compilar extensões PHP com Oracle.

# Segundo passo: Instalação da extensão PHP OCI8

1.  Pegue todos os pacotes essenciais para baixar e compilar a partir de repositórios PEAR:

        $ apt-get install --yes php5 php5-cli php5-dev php-db php-pear
        $ apt-get install --yes build-essential libaio1

2.  Requisite a instalação do OCI8:

        $ pecl install oci8

    Digite `instantclient,/opt/oracle/instantclient` quando perguntado pelo local de instalação do Instant Client.

3.  Salve este texto em `/etc/php5/mods-available/oci8.ini`:

        extension=oci8.so

4.  Ative a extensão:

        $ php5enmod oci8

Agora você tem todas as funções PHP `oci_*` disponíveis tanto via php-cli quanto via Apache.

# Terceiro passo: Instalação da extensão PHP PDO/OCI

A biblioteca `pdo_oci` está desatualizada, então sua instalação é mais &quot;engenhosa&quot;.

1.  Corrija alguns caminhos de arquivo:

        $ cd /usr/include/
        $ ln -s php5 php
        $ cd /opt/oracle/instantclient
        $ mkdir -p include/oracle/11.1/
        $ cd include/oracle/11.1/
        $ ln -s ../../../sdk/include client
        $ cd -
        $ mkdir -p lib/oracle/11.1/client
        $ cd lib/oracle/11.1/client
        $ ln -s ../../../../ lib
        $ cd -

2.  Baixe a `pdo_oci` via `pecl`:

        $ pecl channel-update pear.php.net
        $ mkdir -p /tmp/pear/download/
        $ cd /tmp/pear/download/
        $ pecl download pdo_oci

3.  Extraia o código-fonte:

        $ tar xvf PDO_OCI*.tgz
        $ cd PDO_OCI*

4.  Crie um arquivo chamado `config.m4.patch`:

        *** config.m4   2005-09-24 17:23:24.000000000 -0600
        --- /home/myuser/Desktop/PDO_OCI-1.0/config.m4  2009-07-07 17:32:14.000000000 -0600
        ***************
        *** 7,12 ****
        --- 7,14 ----
            if test -s &quot;$PDO_OCI_DIR/orainst/unix.rgs&quot;; then
              PDO_OCI_VERSION=`grep &apos;&quot;ocommon&quot;&apos; $PDO_OCI_DIR/orainst/unix.rgs | sed &apos;s/[ ][ ]*/:/g&apos; | cut -d: -f 6 | cut -c 2-4`
              test -z &quot;$PDO_OCI_VERSION&quot; &amp;&amp; PDO_OCI_VERSION=7.3
        +   elif test -f $PDO_OCI_DIR/lib/libclntsh.$SHLIB_SUFFIX_NAME.11.1; then
        +     PDO_OCI_VERSION=11.1
            elif test -f $PDO_OCI_DIR/lib/libclntsh.$SHLIB_SUFFIX_NAME.10.1; then
              PDO_OCI_VERSION=10.1
            elif test -f $PDO_OCI_DIR/lib/libclntsh.$SHLIB_SUFFIX_NAME.9.0; then
        ***************
        *** 119,124 ****
        --- 121,129 ----
              10.2)
                PHP_ADD_LIBRARY(clntsh, 1, PDO_OCI_SHARED_LIBADD)
                ;;
        +     11.1)
        +       PHP_ADD_LIBRARY(clntsh, 1, PDO_OCI_SHARED_LIBADD)
        +       ;;
              *)
                AC_MSG_ERROR(Unsupported Oracle version! $PDO_OCI_VERSION)
                ;;
        #EOF

5.  Aplique o patch:

        $ patch --dry-run -i config.m4.patch &amp;&amp; patch -i config.m4.patch &amp;&amp; phpize

6.  Substitua todas as referências de `function_entry` para `zend_function_entry` em `pdo_oci.c`.

7.  Configure, compile e instale:

        $ ORACLE_HOME=/opt/oracle/instantclient ./configure --with-pdo-oci=instantclient,/opt/oracle/instantclient,11.1
        $ make &amp;&amp; make test &amp;&amp; make install &amp;&amp; mv modules/pdo_oci.so /usr/lib/php5/*+lfs/

8.  Salve este texto em `/etc/php5/mods-available/pdo_oci.ini`:

        extension=pdo_oci.so

9.  Ative a extensão:

        $ php5enmod pdo_oci

E agora você pode pegar uma xícara de café.
</content:encoded></item><item><title><![CDATA[Interpretando URLs com DOM]]></title><description><![CDATA[function parseURL(url) { var a = document.createElement('a');
  a.href = url;
  return {
    href: a.href,
    scheme: a.protocol…]]></description><link>https://tassoevan.me/2013-07-24/interpretando-urls-com-dom/</link><guid isPermaLink="false">https://tassoevan.me/2013-07-24/interpretando-urls-com-dom/</guid><pubDate>Wed, 24 Jul 2013 12:01:48 GMT</pubDate><content:encoded>
```js
function parseURL(url) {
  var a = document.createElement(&apos;a&apos;);
  a.href = url;
  return {
    href: a.href,
    scheme: a.protocol,
    host: a.host,
    port: a.port,
    path: a.pathname,
    query: a.search.charAt(0) == &apos;?&apos; ? a.search.substring(1) : null,
    hash: a.hash.charAt(0) == &apos;#&apos; ? a.hash.substring(1) : null,
  };
}
```
</content:encoded></item><item><title><![CDATA[Um método mais confiável para serializar closures]]></title><description><![CDATA[<?php /**
* Serializes a closure as string
* @param \Closure $closure
* @return string
*/
function serializeClosure(\Closure $closure…]]></description><link>https://tassoevan.me/2013-07-19/um-metodo-mais-confiavel-para-serializar-closures/</link><guid isPermaLink="false">https://tassoevan.me/2013-07-19/um-metodo-mais-confiavel-para-serializar-closures/</guid><pubDate>Fri, 19 Jul 2013 00:34:33 GMT</pubDate><content:encoded>
```php
&lt;?php
/**
* Serializes a closure as string
* @param \Closure $closure
* @return string
*/
function serializeClosure(\Closure $closure) {
$ref = new ReflectionFunction($closure);
$tokens = token_get_all(file_get_contents($ref-&gt;getFileName()));

$tokensCount = count($tokens);
$start = false;
$end = $tokensCount;

for ( $i = 0; $i &lt; $tokensCount; ++$i ) {
  if ( is_array($tokens[$i]) &amp;&amp; $tokens[$i][0] === T_FUNCTION &amp;&amp; $tokens[$i][2] == $ref-&gt;getStartLine() ) {
    $start = $i;
    break;
  }
}

for ( $i = $start; $i &lt; $tokensCount; ++$i ) {
  if ( is_array($tokens[$i]) &amp;&amp; $tokens[$i][2] &gt; $ref-&gt;getEndLine() ) {
    $end = $i - 1;
    break;
  }
}

$tokens = array_slice($tokens, $start, $end);

$replaceToken = function($a) { return is_array($a) ? $a[1] : $a; };

while ( count($tokens) &gt; 0 &amp;&amp; $tokens[0][0] === T_FUNCTION ) {

  if ( !getNesting($parameters, $tokens, &apos;(&apos;, &apos;)&apos;) ) // does not have parameters
    break;

  if ( !getNesting($body, $tokens, &apos;{&apos;, &apos;}&apos;, $parameters[&apos;end&apos;]) ) // does not have body
    break;

  if ( ($use_idx = findToken($tokens, T_USE, $parameters[&apos;end&apos;] + 2, $body[&apos;start&apos;] - 2)) !== false )
    getNesting($use, $tokens, &apos;(&apos;, &apos;)&apos;, $use_idx);

  if ( findToken($tokens, T_STRING, 0, $parameters[&apos;start&apos;]) === false ) { // is anonymous function
    while ( getNesting($tmp, $body[&apos;tokens&apos;], T_STATIC, &apos;;&apos;) ) {
      $tmp[&apos;start&apos;]--;
      $tmp[&apos;end&apos;]++;
      array_splice($body[&apos;tokens&apos;], $tmp[&apos;start&apos;], $tmp[&apos;end&apos;]);
    }

    if ( !isset($use) )
      $use = array();

    $closure = compact(&apos;parameters&apos;, &apos;use&apos;, &apos;body&apos;);

    $variables = $ref-&gt;getStaticVariables();

    $source = &quot;return function(&quot; . implode(&apos;&apos;, array_map($replaceToken, $closure[&apos;parameters&apos;][&apos;tokens&apos;])) .  &quot;) &quot;;
    if ( !empty($closure[&apos;use&apos;][&apos;tokens&apos;]) ) {
      $useParams = array_map(&apos;trim&apos;, explode(&apos;,&apos;, implode(&apos;&apos;, array_map($replaceToken, $closure[&apos;use&apos;][&apos;tokens&apos;]))));

      foreach ( $useParams as $param ) {
        if ( $param[0] == &apos;$&apos;)
          $source = &quot;$param = &quot; . var_export($variables[substr($param, 1)], true) . &quot;;\n$source&quot;;
      }

      $source .= &quot;use(&quot; . implode(&apos;, &apos;, $useParams) .  &quot;) &quot;;
    }

    $source .= &quot;{&quot; .  implode(&apos;&apos;, array_map($replaceToken, $closure[&apos;body&apos;][&apos;tokens&apos;])) . &quot;};&quot;;

    $test = function($ref) use($source) {
      $newClosure = eval($source);
      $newRef = new ReflectionFunction($newClosure);

      return ( array_map(function($a) { return $a-&gt;getName(); }, $newRef-&gt;getParameters()) == array_map(function($a) { return $a-&gt;getName(); }, $newRef-&gt;getParameters()) );
    };

    if ( $test($ref) )
      return $source;
  }

  $function_idx = findToken($tokens, T_FUNCTION, $body[&apos;end&apos;] + 2);

  $tokens = $function_idx === false ? array() : array_slice($tokens, $function_idx);
}

return null;
}

function findToken(array $tokens, $needle, $start = 0, $end = PHP_INT_MAX)
{
$idx = false;
for ( $i = $start, $end = min($end, count($tokens)); $i &lt; $end; ++$i ) {
  if ( (is_int($needle) &amp;&amp; is_array($tokens[$i]) &amp;&amp; $tokens[$i][0] === $needle) ||
    is_string($needle) &amp;&amp; is_string($tokens[$i]) &amp;&amp; $tokens[$i] === $needle ) {
    $idx = $i;
    break;
  }
}

return $idx;
}

function getNesting(&amp;$matches, array $tokens, $begin = &apos;{&apos;, $end = &apos;}&apos;, $offset = 0)
{
$level = 0;
$start = false;

for ( $i = $offset, $count = count($tokens); $i &lt; $count; ++$i ) {
  if ( is_array($tokens[$i]) ? ($tokens[$i][0] === $begin) : ($tokens[$i] === $begin) ) {
    ++$level;
    if ( $start === false )
      $start = $i + 1;
  }
  elseif ( is_array($tokens[$i]) ? ($tokens[$i][0] === $end) : ($tokens[$i] === $end) ) {
    if ( $start === false )
      break;

    if ( --$level == 0 ) {
      $matches = array(
        &apos;tokens&apos; =&gt; array_slice($tokens, $start, $i - $start),
        &apos;start&apos; =&gt; $start,
        &apos;end&apos; =&gt; $i - 1
      );
      return true;
    }
  }
}

$matches = null;
return false;
}
```
</content:encoded></item><item><title><![CDATA[Acesso fácil à classe `\Respect\Validation\Validator`]]></title><description><![CDATA[<?php // Author's recommendation
  use Respect\Validation\Validator as v;

  $number = 123;
  v::numeric()->validate($number); //true

  /…]]></description><link>https://tassoevan.me/2013-05-06/acesso-facil-a-classe-respect-validation-validator/</link><guid isPermaLink="false">https://tassoevan.me/2013-05-06/acesso-facil-a-classe-respect-validation-validator/</guid><pubDate>Mon, 06 May 2013 00:08:26 GMT</pubDate><content:encoded>
```php
&lt;?php
  // Author&apos;s recommendation
  use Respect\Validation\Validator as v;

  $number = 123;
  v::numeric()-&gt;validate($number); //true

  // The author method can be a little uncomfortable, because
  // the &apos;v&apos; alias will be present in all source code and it
  // is meaningless according OOP.

  // Here my approach
  $v = &apos;Respect\Validation\Validator&apos;;

  $number = 123;
  $v::numeric()-&gt;validate($number); //true
```
</content:encoded></item><item><title><![CDATA[Inicialização básica de plugins jQuery]]></title><description><![CDATA[// Basic jQuery plugins initialization var MyNamespace = MyNamespace || {};

MyNamespace.applyPlugins = function (parent) {
  if (!parent…]]></description><link>https://tassoevan.me/2013-04-05/inicializacao-basica-de-plugins-jquery/</link><guid isPermaLink="false">https://tassoevan.me/2013-04-05/inicializacao-basica-de-plugins-jquery/</guid><pubDate>Fri, 05 Apr 2013 16:49:03 GMT</pubDate><content:encoded>
```js
// Basic jQuery plugins initialization
var MyNamespace = MyNamespace || {};

MyNamespace.applyPlugins = function (parent) {
  if (!parent) parent = $(&apos;body&apos;);

  $(&apos;[data-focus=auto]&apos;, parent).focus();

  var richEdits = $(&apos;textarea[data-rich=true]&apos;);
  if (richEdits.size() &gt; 0) {
    richEdits.fadeTo(0, 1e-8);

    // head.js used here for instance
    head.js(&apos;/js/vendor/ckeditor/ckeditor.js&apos;).ready(function () {
      richEdits.fadeTo(0, 1).each(function () {
        $(this).myRichEditorPlugin();
      });
    });
  }

  // more stuff ...
};

$(function () {
  MyNamespace.applyPlugins();
});
```
</content:encoded></item><item><title><![CDATA[.htaccess snippets]]></title><description><![CDATA[# ------------------------------------------------------------------------------ # Redirecionar para mobile a partir do agente de usuário
#…]]></description><link>https://tassoevan.me/2013-03-21/htaccess-snippets/</link><guid isPermaLink="false">https://tassoevan.me/2013-03-21/htaccess-snippets/</guid><pubDate>Thu, 21 Mar 2013 20:01:16 GMT</pubDate><content:encoded>
```htaccess
# ------------------------------------------------------------------------------
# Redirecionar para mobile a partir do agente de usuário
# ------------------------------------------------------------------------------
&lt;IfModule mod_rewrite.c&gt;
   RewriteEngine On
   RewriteCond %{HTTP_USER_AGENT} &quot;android|blackberry|googlebot-mobile|iemobile|ipad|iphone|ipod|opera mobile|palmos|webos&quot; [NC]
   RewriteRule ^$ http://m.example.com/ [L,R=302]
&lt;/IfModule&gt;
&lt;IfModule mod_rewrite.c&gt;
   RewriteEngine On
   RewriteCond %{HTTP_USER_AGENT} &quot;!(android|blackberry|googlebot-mobile|iemobile|ipad|iphone|ipod|opera mobile|palmos|webos)&quot; [NC]
   RewriteRule ^$ http://www.example.com/ [L,R=302]
&lt;/IfModule&gt;

# ------------------------------------------------------------------------------
# Ativar Google Chrome Frame
# ------------------------------------------------------------------------------
&lt;IfModule mod_headers.c&gt;
  Header set X-UA-Compatible &quot;IE=Edge,chrome=1&quot;
  &lt;FilesMatch &quot;\.(appcache|crx|css|eot|gif|htc|ico|jpe?g|js|m4a|m4v|manifest|mp4|oex|oga|ogg|ogv|otf|pdf|png|safariextz|svg|svgz|ttf|vcf|webm|webp|woff|xml|xpi)$&quot;&gt;
      Header unset X-UA-Compatible
  &lt;/FilesMatch&gt;
&lt;/IfModule&gt;

# ------------------------------------------------------------------------------
# Permissão de acesso às Webfonts
# ------------------------------------------------------------------------------
# Nota: qualquer domínio pode ser especificado no lugar de &quot;*&quot;
&lt;IfModule mod_headers.c&gt;
  &lt;FilesMatch &quot;\.(eot|font.css|otf|ttc|ttf|woff)$&quot;&gt;
      Header set Access-Control-Allow-Origin &quot;*&quot;
  &lt;/FilesMatch&gt;
&lt;/IfModule&gt;

# ------------------------------------------------------------------------------
# MIME type apropriado para todos os arquivos
# ------------------------------------------------------------------------------
AddType application/javascript         js jsonp
AddType application/json               json
AddType audio/mp4                      m4a f4a f4b
AddType audio/ogg                      oga ogg
AddType video/mp4                      mp4 m4v f4v f4p
AddType video/ogg                      ogv
AddType video/webm                     webm
AddType video/x-flv                    flv
AddType     image/svg+xml              svg svgz
AddEncoding gzip                       svgz
AddType application/vnd.ms-fontobject  eot
AddType application/x-font-ttf         ttf ttc
AddType application/x-font-woff        woff
AddType font/opentype                  otf
AddType application/octet-stream            safariextz
AddType application/x-chrome-extension      crx
AddType application/x-opera-extension       oex
AddType application/x-shockwave-flash       swf
AddType application/x-web-app-manifest+json webapp
AddType application/x-xpinstall             xpi
AddType application/xml                     rss atom xml rdf
AddType image/webp                          webp
AddType image/x-icon                        ico
AddType text/cache-manifest                 appcache manifest
AddType text/vtt                            vtt
AddType text/x-component                    htc
AddType text/x-vcard                        vcf

# ------------------------------------------------------------------------------
# Compressão gzip
# ------------------------------------------------------------------------------
&lt;IfModule mod_deflate.c&gt;
  &lt;IfModule mod_setenvif.c&gt;
      &lt;IfModule mod_headers.c&gt;
          SetEnvIfNoCase ^(Accept-EncodXng|X-cept-Encoding|X{15}|~{15}|-{15})$ ^((gzip|deflate)\s*,?\s*)+|[X~-]{4,13}$ HAVE_Accept-Encoding
          RequestHeader append Accept-Encoding &quot;gzip,deflate&quot; env=HAVE_Accept-Encoding
      &lt;/IfModule&gt;
  &lt;/IfModule&gt;
  &lt;IfModule mod_filter.c&gt;
      AddOutputFilterByType DEFLATE application/atom+xml \
                                    application/javascript \
                                    application/json \
                                    application/rss+xml \
                                    application/vnd.ms-fontobject \
                                    application/x-font-ttf \
                                    application/xhtml+xml \
                                    application/xml \
                                    font/opentype \
                                    image/svg+xml \
                                    image/x-icon \
                                    text/css \
                                    text/html \
                                    text/plain \
                                    text/x-component \
                                    text/xml
  &lt;/IfModule&gt;
&lt;/IfModule&gt;

# ------------------------------------------------------------------------------
# Expires headers (para um melhor controle de cache)
# ------------------------------------------------------------------------------
&lt;IfModule mod_expires.c&gt;
  ExpiresActive on
  ExpiresDefault                          &quot;access plus 1 minute&quot;

  ExpiresByType text/cache-manifest       &quot;access plus 0 seconds&quot;
  ExpiresByType text/html                 &quot;access plus 0 seconds&quot;
  ExpiresByType application/json          &quot;access plus 0 seconds&quot;
  ExpiresByType application/xml           &quot;access plus 0 seconds&quot;
  ExpiresByType text/xml                  &quot;access plus 0 seconds&quot;
  ExpiresByType application/atom+xml      &quot;access plus 1 hour&quot;
  ExpiresByType application/rss+xml       &quot;access plus 1 hour&quot;
  ExpiresByType image/x-icon              &quot;access plus 1 minute&quot;
  ExpiresByType audio/ogg                 &quot;access plus 1 month&quot;
  ExpiresByType image/gif                 &quot;access plus 1 month&quot;
  ExpiresByType image/jpeg                &quot;access plus 1 month&quot;
  ExpiresByType image/png                 &quot;access plus 1 month&quot;
  ExpiresByType video/mp4                 &quot;access plus 1 month&quot;
  ExpiresByType video/ogg                 &quot;access plus 1 month&quot;
  ExpiresByType video/webm                &quot;access plus 1 month&quot;
  ExpiresByType text/x-component          &quot;access plus 1 month&quot;
  ExpiresByType application/vnd.ms-fontobject &quot;access plus 1 month&quot;
  ExpiresByType application/x-font-ttf    &quot;access plus 1 month&quot;
  ExpiresByType application/x-font-woff   &quot;access plus 1 month&quot;
  ExpiresByType font/opentype             &quot;access plus 1 month&quot;
  ExpiresByType image/svg+xml             &quot;access plus 1 month&quot;
  ExpiresByType application/javascript    &quot;access plus 1 minute&quot;
  ExpiresByType text/css                  &quot;access plus 1 minute&quot;
&lt;/IfModule&gt;

# ------------------------------------------------------------------------------
# Remoção de ETag
# ------------------------------------------------------------------------------
&lt;IfModule mod_headers.c&gt;
  Header unset ETag
&lt;/IfModule&gt;
FileETag None

# ------------------------------------------------------------------------------
# Remover o flicker em rollovers CSS no Internet Explorer
# ------------------------------------------------------------------------------
BrowserMatch &quot;MSIE&quot; brokenvary=1
BrowserMatch &quot;Mozilla/4.[0-9]{2}&quot; brokenvary=1
BrowserMatch &quot;Opera&quot; !brokenvary
SetEnvIf brokenvary 1 force-no-vary

# ------------------------------------------------------------------------------
# Requisições AJAX cross-domain
# ------------------------------------------------------------------------------
&lt;IfModule mod_headers.c&gt;
  Header set Access-Control-Allow-Origin &quot;*&quot;
&lt;/IfModule&gt;

# ------------------------------------------------------------------------------
# Imagens CORS habilitadas (@crossorigin)
# ------------------------------------------------------------------------------
&lt;IfModule mod_setenvif.c&gt;
  &lt;IfModule mod_headers.c&gt;
      &lt;FilesMatch &quot;\.(gif|ico|jpe?g|png|svg|svgz|webp)$&quot;&gt;
          SetEnvIf Origin &quot;:&quot; IS_CORS
          Header set Access-Control-Allow-Origin &quot;*&quot; env=IS_CORS
      &lt;/FilesMatch&gt;
  &lt;/IfModule&gt;
&lt;/IfModule&gt;

# ------------------------------------------------------------------------------
# Concatenação entre arquivos js e css específicos
# ------------------------------------------------------------------------------
# Nota: e.g., em script.combined.js você pode ter
#       &lt;!--#include file=&quot;libs/jquery-1.5.0.min.js&quot; --&gt;
#       &lt;!--#include file=&quot;plugins/jquery.idletimer.js&quot; --&gt;
&lt;FilesMatch &quot;\.combined\.js$&quot;&gt;
  Options +Includes
  AddOutputFilterByType INCLUDES application/javascript application/json
  SetOutputFilter INCLUDES
&lt;/FilesMatch&gt;
&lt;FilesMatch &quot;\.combined\.css$&quot;&gt;
  Options +Includes
  AddOutputFilterByType INCLUDES text/css
  SetOutputFilter INCLUDES
&lt;/FilesMatch&gt;

# ------------------------------------------------------------------------------
# Impedir provedores de redes mobile (3G) de modificar seu site
# ------------------------------------------------------------------------------
&lt;IfModule mod_headers.c&gt;
  Header set Cache-Control &quot;no-transform&quot;
&lt;/IfModule&gt;

# ------------------------------------------------------------------------------
# Keep-Alive
# ------------------------------------------------------------------------------
# Nota: existem algumas desvantagens em habilitar esta opção.
#       Ative-a se você serve muito conteúdo estático
&lt;IfModule mod_headers.c&gt;
  Header set Connection Keep-Alive
&lt;/IfModule&gt;

# ------------------------------------------------------------------------------
# Permitir a criação de cookies em iframes
# ------------------------------------------------------------------------------
# Nota: apenas Internet Explorer
&lt;IfModule mod_headers.c&gt;
  Header set P3P &quot;policyref=\&quot;/w3c/p3p.xml\&quot;, CP=\&quot;IDC DSP COR ADM DEVi TAIi PSA PSD IVAi IVDi CONi HIS OUR IND CNT\&quot;&quot;
&lt;/IfModule&gt;

# ------------------------------------------------------------------------------
# Iniciar o motor de reescrita de URLs
# ------------------------------------------------------------------------------
&lt;IfModule mod_rewrite.c&gt;
  Options +FollowSymlinks
  RewriteEngine On
#   RewriteBase /
&lt;/IfModule&gt;

# ------------------------------------------------------------------------------
# Reescrever &quot;example.com -&gt; www.example.com&quot;
# ------------------------------------------------------------------------------
&lt;IfModule mod_rewrite.c&gt;
  RewriteCond %{HTTPS} !=on
  RewriteCond %{HTTP_HOST} !^www\..+$
  # Exceto para localhost
  RewriteCond %{HTTP_HOST} !^localhost$
  # Exceto para endereço IP
  RewriteCond %{HTTP_HOST} !^(\d{1,3}\.){3}\d{1,3}$ [NC]
  RewriteRule ^ http://www.%{HTTP_HOST}%{REQUEST_URI} [R=301,L]
&lt;/IfModule&gt;

# ------------------------------------------------------------------------------
# Reescrever &quot;www.example.com -&gt; example.com&quot;
# ------------------------------------------------------------------------------
&lt;IfModule mod_rewrite.c&gt;
  RewriteCond %{HTTPS} !=on
  RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
  RewriteRule ^ http://%1%{REQUEST_URI} [R=301,L]
&lt;/IfModule&gt;

# ------------------------------------------------------------------------------
# Melhor cache baseado em nome de arquivo
# ------------------------------------------------------------------------------
# Nota: link &quot;css/estilos.css&quot; como &quot;css/estilos.123.css&quot;
&lt;IfModule mod_rewrite.c&gt;
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule ^(.+)\.(\d+)\.(js|css|png|jpg|gif)$ $1.$3 [L]
&lt;/IfModule&gt;

# ------------------------------------------------------------------------------
# Impedir alguns alertas SSL
# ------------------------------------------------------------------------------
&lt;IfModule mod_rewrite.c&gt;
  RewriteCond %{SERVER_PORT} !^443
  RewriteRule ^ https://example.com%{REQUEST_URI} [R=301,L]
&lt;/IfModule&gt;

# ------------------------------------------------------------------------------
# Impedir erros 404 para pastas não existentes em URIs reescritas
# ------------------------------------------------------------------------------
Options -MultiViews

# ------------------------------------------------------------------------------
# Página 404 personalizada
# ------------------------------------------------------------------------------
ErrorDocument 404 /404.html

# ------------------------------------------------------------------------------
# Codificação UTF-8
# ------------------------------------------------------------------------------
AddDefaultCharset utf-8
AddCharset utf-8 .atom .css .js .json .rss .vtt .xml

# ------------------------------------------------------------------------------
# Remover assinatura do servidor
# ------------------------------------------------------------------------------
# Nota: apenas para a httpd.conf
ServerSignature Off
ServerTokens Prod

# ------------------------------------------------------------------------------
# Impedir listagem em diretórios sem documento padrão
# ------------------------------------------------------------------------------
&lt;IfModule mod_autoindex.c&gt;
  Options -Indexes
&lt;/IfModule&gt;

# ------------------------------------------------------------------------------
# Impedir acesso a diretórios ocultos no Linux
# ------------------------------------------------------------------------------
# Nota: são diretórios cujo nome inicial com ponto, e.g. &quot;.git&quot;
&lt;IfModule mod_rewrite.c&gt;
  RewriteCond %{SCRIPT_FILENAME} -d [OR]
  RewriteCond %{SCRIPT_FILENAME} -f
  RewriteRule &quot;(^|/)\.&quot; - [F]
&lt;/IfModule&gt;

# ------------------------------------------------------------------------------
# Impedir acesso a arquivos de becape, código-fonte e configuração
# ------------------------------------------------------------------------------
&lt;FilesMatch &quot;(\.(bak|config|dist|fla|inc|ini|log|psd|sh|sql|swp)|~)$&quot;&gt;
  Order allow,deny
  Deny from all
  Satisfy All
&lt;/FilesMatch&gt;

# ------------------------------------------------------------------------------
# Configurações seguras para o PHP
# ------------------------------------------------------------------------------
# Nota: nem todos servidores suportam essas modificações via .htaccess
php_flag  register_globals       Off
php_value session.name           SESSIONID
php_flag  magic_quotes_gpc       Off
php_flag  expose_php             Off
php_value error_reporting        -1
php_flag  log_errors             On
php_flag  display_errors         Off
php_flag  display_startup_errors Off
php_flag  html_errors            Off
php_flag  ignore_repeated_errors Off
php_flag  ignore_repeated_source Off
php_value log_errors_max_len     1024
php_value error_prepend_string   &quot; &quot;
php_value error_append_string    &quot; &quot;
&lt;IfModule mod_php5.c&gt;
  php_value session.cookie_httponly true
&lt;/IfModule&gt;

# ------------------------------------------------------------------------------
# Redirecionar acesso para router PHP
# ------------------------------------------------------------------------------
# Nota: &quot;E=app:main&quot; especifica a variável
#       $_SERVER[&apos;REDIRECT_app&apos;] = &apos;main&apos;;
&lt;IfModule mod_rewrite.c&gt;
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteRule ^ index.php [QSA,E=app:main,L]
&lt;/IfModule&gt;
```
</content:encoded></item></channel></rss>