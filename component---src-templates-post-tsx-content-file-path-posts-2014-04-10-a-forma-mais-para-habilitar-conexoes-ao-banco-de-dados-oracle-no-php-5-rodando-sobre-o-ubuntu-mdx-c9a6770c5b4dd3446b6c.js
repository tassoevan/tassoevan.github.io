"use strict";(self.webpackChunk_tassoevan_tassoevan_github_io=self.webpackChunk_tassoevan_tassoevan_github_io||[]).push([[509],{8557:function(e,n,t){t.r(n),t.d(n,{default:function(){return p}});var l=t(8453),a=t(6540);function c(e){const n=Object.assign({p:"p",a:"a",ul:"ul",li:"li",h1:"h1",ol:"ol",code:"code",em:"em",hr:"hr"},(0,l.R)(),e.components);return a.createElement(a.Fragment,null,a.createElement(n.p,null,"Este artigo está disponível como ",a.createElement(n.a,{href:"https://gist.github.com/tassoevan/10392954"},"um gist"),". Sinta-se livre para contribuir."),"\n",a.createElement(n.p,null,"Agradecimentos especiais para:"),"\n",a.createElement(n.ul,null,"\n",a.createElement(n.li,null,a.createElement(n.a,{href:"https://twitter.com/coolaj86"},"AJ ONeal")),"\n",a.createElement(n.li,null,a.createElement(n.a,{href:"http://hsiaosiyuan.com/wp/"},"Hsiao Siyuan")),"\n"),"\n",a.createElement(n.h1,null,"Primeiro passo: Instalação do cliente Oracle"),"\n",a.createElement(n.ol,null,"\n",a.createElement(n.li,null,"\n",a.createElement(n.p,null,"Faça o download do Instant Client em ",a.createElement(n.a,{href:"http://www.oracle.com/technetwork/indexes/downloads/index.html#database"},"http://www.oracle.com/technetwork/indexes/downloads/index.html#database")," (você deve ter um usuário registrado no site da Oracle; o registro é gratuito). Você precisa dos arquivos ",a.createElement(n.code,null,"instantclient-basic-*-*.zip")," e ",a.createElement(n.code,null,"instantclient-sdk-*-*.zip"),"."),"\n"),"\n",a.createElement(n.li,null,"\n",a.createElement(n.p,null,"Execute os seguintes comandos no seu terminal:"),"\n",a.createElement(n.p,null,"$ sudo su -\n$ mkdir -p /opt/oracle/instantclient\n$ cd /opt/oracle/instantclient"),"\n"),"\n",a.createElement(n.li,null,"\n",a.createElement(n.p,null,"Copie os arquivos baixados em ",a.createElement(n.code,null,"/opt/oracle/instantclient"),"."),"\n"),"\n",a.createElement(n.li,null,"\n",a.createElement(n.p,null,"Descompacte os arquivos executando estes comandos:"),"\n",a.createElement(n.p,null,"$ unzip instantclient-basic-",a.createElement(n.em,null,"-"),".zip\n$ unzip instantclient-sdk-",a.createElement(n.em,null,"-"),".zip"),"\n"),"\n",a.createElement(n.li,null,"\n",a.createElement(n.p,null,"Mova todos o conteúdo de ",a.createElement(n.code,null,"/opt/oracle/instantclient/instantclient")," para ",a.createElement(n.code,null,"/opt/oracle/instantclient"),":"),"\n",a.createElement(n.p,null,"$ mv instantclient*/* ./\n$ rmdir instantclient*/"),"\n"),"\n",a.createElement(n.li,null,"\n",a.createElement(n.p,null,"Durante a compilação do código da extensão, alguns erros podem surgir quando forem resolvidas as dependências de algumas libraries. Para evitá-los, faça:"),"\n",a.createElement(n.p,null,"$ ln -s libclntsh.so.* libclntsh.so\n$ ln -s libocci.so.* libocci.so\n$ echo /opt/oracle/instantclient >> /etc/ld.so.conf\n$ ldconfig"),"\n"),"\n",a.createElement(n.li,null,"\n",a.createElement(n.p,null,"Crie um diretório para seus arquivos de configuração de rede:"),"\n",a.createElement(n.p,null,"$ mkdir -p network/admin"),"\n"),"\n",a.createElement(n.li,null,"\n",a.createElement(n.p,null,"Coloque os arquivos ",a.createElement(n.code,null,"sqlnet.ora")," e ",a.createElement(n.code,null,"tnsnames.ora")," em ",a.createElement(n.code,null,"/opt/oracle/instantclient/network/admin"),"."),"\n"),"\n"),"\n",a.createElement(n.p,null,"Agora você tem o kit básico para conexões e acesso à SDK para compilar extensões PHP com Oracle."),"\n",a.createElement(n.h1,null,"Segundo passo: Instalação da extensão PHP OCI8"),"\n",a.createElement(n.ol,null,"\n",a.createElement(n.li,null,"\n",a.createElement(n.p,null,"Pegue todos os pacotes essenciais para baixar e compilar a partir de repositórios PEAR:"),"\n",a.createElement(n.p,null,"$ apt-get install --yes php5 php5-cli php5-dev php-db php-pear\n$ apt-get install --yes build-essential libaio1"),"\n"),"\n",a.createElement(n.li,null,"\n",a.createElement(n.p,null,"Requisite a instalação do OCI8:"),"\n",a.createElement(n.p,null,"$ pecl install oci8"),"\n",a.createElement(n.p,null,"Digite ",a.createElement(n.code,null,"instantclient,/opt/oracle/instantclient")," quando perguntado pelo local de instalação do Instant Client."),"\n"),"\n",a.createElement(n.li,null,"\n",a.createElement(n.p,null,"Salve este texto em ",a.createElement(n.code,null,"/etc/php5/mods-available/oci8.ini"),":"),"\n",a.createElement(n.p,null,"extension=oci8.so"),"\n"),"\n",a.createElement(n.li,null,"\n",a.createElement(n.p,null,"Ative a extensão:"),"\n",a.createElement(n.p,null,"$ php5enmod oci8"),"\n"),"\n"),"\n",a.createElement(n.p,null,"Agora você tem todas as funções PHP ",a.createElement(n.code,null,"oci_*")," disponíveis tanto via php-cli quanto via Apache."),"\n",a.createElement(n.h1,null,"Terceiro passo: Instalação da extensão PHP PDO/OCI"),"\n",a.createElement(n.p,null,"A biblioteca ",a.createElement(n.code,null,"pdo_oci"),' está desatualizada, então sua instalação é mais "engenhosa".'),"\n",a.createElement(n.ol,null,"\n",a.createElement(n.li,null,"\n",a.createElement(n.p,null,"Corrija alguns caminhos de arquivo:"),"\n",a.createElement(n.p,null,"$ cd /usr/include/\n$ ln -s php5 php\n$ cd /opt/oracle/instantclient\n$ mkdir -p include/oracle/11.1/\n$ cd include/oracle/11.1/\n$ ln -s ../../../sdk/include client\n$ cd -\n$ mkdir -p lib/oracle/11.1/client\n$ cd lib/oracle/11.1/client\n$ ln -s ../../../../ lib\n$ cd -"),"\n"),"\n",a.createElement(n.li,null,"\n",a.createElement(n.p,null,"Baixe a ",a.createElement(n.code,null,"pdo_oci")," via ",a.createElement(n.code,null,"pecl"),":"),"\n",a.createElement(n.p,null,"$ pecl channel-update pear.php.net\n$ mkdir -p /tmp/pear/download/\n$ cd /tmp/pear/download/\n$ pecl download pdo_oci"),"\n"),"\n",a.createElement(n.li,null,"\n",a.createElement(n.p,null,"Extraia o código-fonte:"),"\n",a.createElement(n.p,null,"$ tar xvf PDO_OCI*.tgz\n$ cd PDO_OCI*"),"\n"),"\n",a.createElement(n.li,null,"\n",a.createElement(n.p,null,"Crie um arquivo chamado ",a.createElement(n.code,null,"config.m4.patch"),":"),"\n",a.createElement(n.p,null,"*** config.m4   2005-09-24 17:23:24.000000000 -0600\n--- /home/myuser/Desktop/PDO_OCI-1.0/config.m4  2009-07-07 17:32:14.000000000 -0600"),"\n",a.createElement(n.hr),"\n",a.createElement(n.p,null,'*** 7,12 ****\n--- 7,14 ----\nif test -s "$PDO_OCI_DIR/orainst/unix.rgs"; then\nPDO_OCI_VERSION=',a.createElement(n.code,null,"grep '\"ocommon\"' $PDO_OCI_DIR/orainst/unix.rgs | sed 's/[ ][ ]*/:/g' | cut -d: -f 6 | cut -c 2-4"),'\ntest -z "$PDO_OCI_VERSION" && PDO_OCI_VERSION=7.3'),"\n",a.createElement(n.ul,null,"\n",a.createElement(n.li,null,"elif test -f $PDO_OCI_DIR/lib/libclntsh.$SHLIB_SUFFIX_NAME.11.1; then"),"\n",a.createElement(n.li,null,"PDO_OCI_VERSION=11.1\nelif test -f $PDO_OCI_DIR/lib/libclntsh.$SHLIB_SUFFIX_NAME.10.1; then\nPDO_OCI_VERSION=10.1\nelif test -f $PDO_OCI_DIR/lib/libclntsh.$SHLIB_SUFFIX_NAME.9.0; then"),"\n"),"\n",a.createElement(n.hr),"\n",a.createElement(n.p,null,"*** 119,124 ****\n--- 121,129 ----\n10.2)\nPHP_ADD_LIBRARY(clntsh, 1, PDO_OCI_SHARED_LIBADD)\n;;"),"\n",a.createElement(n.ul,null,"\n",a.createElement(n.li,null,"11.1)"),"\n",a.createElement(n.li,null,"PHP_ADD_LIBRARY(clntsh, 1, PDO_OCI_SHARED_LIBADD)"),"\n",a.createElement(n.li,null,";;\n*)\nAC_MSG_ERROR(Unsupported Oracle version! $PDO_OCI_VERSION)\n;;\n#EOF"),"\n"),"\n"),"\n",a.createElement(n.li,null,"\n",a.createElement(n.p,null,"Aplique o patch:"),"\n",a.createElement(n.p,null,"$ patch --dry-run -i config.m4.patch && patch -i config.m4.patch && phpize"),"\n"),"\n",a.createElement(n.li,null,"\n",a.createElement(n.p,null,"Substitua todas as referências de ",a.createElement(n.code,null,"function_entry")," para ",a.createElement(n.code,null,"zend_function_entry")," em ",a.createElement(n.code,null,"pdo_oci.c"),"."),"\n"),"\n",a.createElement(n.li,null,"\n",a.createElement(n.p,null,"Configure, compile e instale:"),"\n",a.createElement(n.p,null,"$ ORACLE_HOME=/opt/oracle/instantclient ./configure --with-pdo-oci=instantclient,/opt/oracle/instantclient,11.1\n$ make && make test && make install && mv modules/pdo_oci.so /usr/lib/php5/*+lfs/"),"\n"),"\n",a.createElement(n.li,null,"\n",a.createElement(n.p,null,"Salve este texto em ",a.createElement(n.code,null,"/etc/php5/mods-available/pdo_oci.ini"),":"),"\n",a.createElement(n.p,null,"extension=pdo_oci.so"),"\n"),"\n",a.createElement(n.li,null,"\n",a.createElement(n.p,null,"Ative a extensão:"),"\n",a.createElement(n.p,null,"$ php5enmod pdo_oci"),"\n"),"\n"),"\n",a.createElement(n.p,null,"E agora você pode pegar uma xícara de café."))}var o=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,l.R)(),e.components);return n?a.createElement(n,e,a.createElement(c,e)):c(e)},i=t(4387),r=t(6008),s=t(9031),u=t(4615);function m(e){let{pageContext:n,data:t,children:l}=e;const{frontmatter:{title:c,date:o},slug:m,next:p}=n,{excerpt:d,timeToRead:E}=t.mdx;return a.createElement(a.Fragment,null,a.createElement(i.A,{title:c,description:d}),a.createElement(r.A,null,a.createElement(s.A,null),a.createElement(u.A,{slug:m,title:c,date:new Date(Date.parse(o)),timeToRead:Math.ceil(E),next:p},l)))}function p(e){return a.createElement(m,e,a.createElement(o,e))}},9031:function(e,n,t){var l=t(6540),a=t(7581),c=t(8864),o=t(4017);const i=a.default.nav.withConfig({displayName:"NavBar__StyledNavBar",componentId:"sc-yc90xv-0"})(["h1{font-size:1em;font-weight:normal;margin:0;}"]);n.A=function(){const{title:e,description:n}=(0,c.Q)();return l.createElement(i,null,l.createElement("h1",null,l.createElement(o.A,{href:"/",title:n},e)))}},8453:function(e,n,t){t.d(n,{R:function(){return o}});var l=t(6540);const a={},c=l.createContext(a);function o(e){const n=l.useContext(c);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}}}]);
//# sourceMappingURL=component---src-templates-post-tsx-content-file-path-posts-2014-04-10-a-forma-mais-para-habilitar-conexoes-ao-banco-de-dados-oracle-no-php-5-rodando-sobre-o-ubuntu-mdx-c9a6770c5b4dd3446b6c.js.map