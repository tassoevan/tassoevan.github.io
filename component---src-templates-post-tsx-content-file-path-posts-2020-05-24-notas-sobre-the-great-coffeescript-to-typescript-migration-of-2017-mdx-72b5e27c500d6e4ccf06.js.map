{"version":3,"file":"component---src-templates-post-tsx-content-file-path-posts-2020-05-24-notas-sobre-the-great-coffeescript-to-typescript-migration-of-2017-mdx-72b5e27c500d6e4ccf06.js","mappings":"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","sources":["webpack://@tassoevan/tassoevan.github.io/./posts/2020-05-24/notas-sobre-the-great-coffeescript-to-typescript-migration-of-2017.mdx","webpack://@tassoevan/tassoevan.github.io/./src/templates/post.tsx","webpack://@tassoevan/tassoevan.github.io/./src/components/NavBar.tsx","webpack://@tassoevan/tassoevan.github.io/./node_modules/@mdx-js/react/lib/index.js"],"sourcesContent":["/*@jsxRuntime classic @jsx React.createElement @jsxFrag React.Fragment*/\nimport {useMDXComponents as _provideComponents} from \"@mdx-js/react\";\nimport React from \"react\";\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    h2: \"h2\",\n    ul: \"ul\",\n    li: \"li\",\n    em: \"em\",\n    code: \"code\",\n    a: \"a\",\n    ol: \"ol\"\n  }, _provideComponents(), props.components);\n  return React.createElement(React.Fragment, null, React.createElement(_components.p, null, \"Fonte: https://dropbox.tech/frontend/the-great-coffeescript-to-typescript-migration-of-2017\"), \"\\n\", React.createElement(_components.h2, null, \"Pré-história: adoção de CoffeeScript\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"Em 2012, o Dropbox era uma startup com 150 funcionários.\"), \"\\n\", React.createElement(_components.li, null, \"ES5 e jQuery dominavam o desenvolvimento JavaScript.\"), \"\\n\", React.createElement(_components.li, null, \"A codebase consistia de cerca de 100 mil linhas de JavaScript empacotada por simples concatenação de arquivos.\"), \"\\n\", React.createElement(_components.li, null, \"Dois engenheiros migraram tudo para CoffeeScript em uma semana.\"), \"\\n\", React.createElement(_components.li, null, \"Em 2013, adotaram o sistema de módulos RequireJS (AMD) já que CommonJS era restrita a Node e, portanto, não projetada para uso no browser.\"), \"\\n\"), \"\\n\", React.createElement(_components.h2, null, \"Rumores de uma mudança de linguagem\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"Ao final de 2015, ES6 já tinha mais funcionalidades que CoffeeScript.\"), \"\\n\", React.createElement(_components.li, null, \"Alguns times começaram a adotar ES6 em projetos isolados.\"), \"\\n\", React.createElement(_components.li, null, \"A codebase era difícil de manter pois as técnicas de codificação defensiva eram insuficientes e prejudicavam a legibilidade do código.\"), \"\\n\", React.createElement(_components.li, null, \"Por CoffeeScript ser menos estrita que Python no uso de whitespaces, alguns engenheiros verificavam manualmente o código JavaScript gerado; é citado um bug sério no outono de 2013 causado por um espaço em branco mal-posicionado.\"), \"\\n\", React.createElement(_components.li, null, \"Uma pesquisa interna em novembro de 2015 verificou que 62% dos desenvolvedores gostariam de mudar a linguagem utilizada.\"), \"\\n\", React.createElement(_components.li, null, \"Problemas com CoffeeScript apontados:\", \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"Falta de delimitadores\"), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.em, null, \"Syntactic sugar\"), \" muito opinativo\"), \"\\n\", React.createElement(_components.li, null, \"Falta de suporte da comunidade\"), \"\\n\", React.createElement(_components.li, null, \"Leitura difícil pois a sintaxe é muito densa\"), \"\\n\", React.createElement(_components.li, null, \"Sujeita a erros por causa de ambiguidades sintáticas\"), \"\\n\"), \"\\n\"), \"\\n\", React.createElement(_components.li, null, \"O ferramental de TypeScript parecia melhor que vanilla ES6 + Flow no final de 2015.\"), \"\\n\", React.createElement(_components.li, null, \"No primeiro semestre de 2016, um engenheiro integrou Babel e TypeScript.\"), \"\\n\", React.createElement(_components.li, null, \"Tanto o time quanto a codebase (330 mil linhas) haviam crescido significativamente para uma migração indolor.\"), \"\\n\"), \"\\n\", React.createElement(_components.h2, null, \"Um plano de migração otimista\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"Foram estabelecidas cinco \", React.createElement(_components.em, null, \"milestones\"), \" a serem cumpridas até julho de 2017:\\nM1. Suporte básico a TypeScript com interoperabilidade com CoffeeScript e ferramentas de i18n, lint e testes;\\nM2. Documentar boas práticas e guias de migração e migrar as principais bibliotecas e módulos para TypeScript ser a linguagem padrão de desenvolvimento;\\nM3. Consolidar a \", React.createElement(_components.em, null, \"milestone\"), \" anterior migrando o restante de módulos e bibliotecas;\\nM4. Migrar os arquivos mais modificados ao longo do tempo no projeto;\\nM5. Remover o compilador de CoffeeScript.\"), \"\\n\", React.createElement(_components.li, null, \"M1, M2 e M3 foram executadas no segundo semestre de 2016.\"), \"\\n\", React.createElement(_components.li, null, \"M4 e M5 foram mais problemáticas; esperava-se que o código ficaria a cargo dos times que o desenvolveram originalmente.\"), \"\\n\", React.createElement(_components.li, null, \"20% do time de produto foi alocado para trabalhar nas \\\"fundações\\\" da codebase.\"), \"\\n\"), \"\\n\", React.createElement(_components.h2, null, \"Interoperabilidade de CoffeeScript/TypeScript\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"Para cada arquivo de CoffeeScript (\", React.createElement(_components.code, null, \"*.coffee\"), \"), foi criado um arquivo de declarações (\", React.createElement(_components.code, null, \"*.d.ts\"), \") exportando os módulos como \", React.createElement(_components.code, null, \"any\"), \".\"), \"\\n\", React.createElement(_components.li, null, \"Módulos em TS com \", React.createElement(_components.code, null, \"export default value;\"), \" eram importados nos módulos AMD como objetos do tipo \", React.createElement(_components.code, null, \"{ default: value }\"), \"; named exports foram migrados com poucos problemas.\"), \"\\n\", React.createElement(_components.li, null, \"Em módulos cujos exports eram dinamicamente determinados, exportou-se todos os identificadores possíveis mas com valores \", React.createElement(_components.code, null, \"undefined\"), \" dinamicamente determinados.\"), \"\\n\"), \"\\n\", React.createElement(_components.h2, null, \"Banindo novos arquivos em CoffeeScript\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"Foi criado um teste automático para barrar a adição de novos arquivos.\"), \"\\n\", React.createElement(_components.li, null, \"Este teste quebrou quando uma migração paralela para \", React.createElement(_components.a, {\n    href: \"https://bazel.build/\"\n  }, \"Bazel\"), \" como sistema de build foi executada, pois a lista de arquivos \", React.createElement(_components.code, null, \"*.coffee\"), \" estava vazia.\"), \"\\n\", React.createElement(_components.li, null, \"Como aprendizado, testes passaram a fazer asserções em suposições (neste caso, de que a lista nunca seria vazia).\"), \"\\n\", React.createElement(_components.li, null, \"A redução da \", React.createElement(_components.em, null, \"whitelist\"), \" de arquivos permitidos gerava pequenos atrasos no code review.\"), \"\\n\"), \"\\n\", React.createElement(_components.h2, null, \"Experiência inicial: não perdemos o \", React.createElement(_components.em, null, \"syntactic sugar\"), \" do CoffeeScript\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"A perda de \", React.createElement(_components.em, null, \"optional chaining\"), \" e \", React.createElement(_components.em, null, \"nullish coalescing\"), \" foi compensada com a adição de tipagem.\"), \"\\n\"), \"\\n\", React.createElement(_components.h2, null, \"Prioridades concorrentes\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"No final de 2016, foi criado um time para redesign e reescrita do website em React (\\\"Maestro\\\").\"), \"\\n\", React.createElement(_components.li, null, \"O time do Maestro não conseguiu cumprir o prazo do primeiro trimestre, entregando ao término do segundo o projeto completo em React e TypeScript.\"), \"\\n\", React.createElement(_components.li, null, \"A lista de arquivos que deveria ser eliminada na M4 estagnou em 100 arquivos, mas na prática ainda haviam 2000 arquivos em CoffeeScript com manutenção constante.\"), \"\\n\"), \"\\n\", React.createElement(_components.h2, null, \"Adiando a M5\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"Interpretou-se erroneamente que os scripts restantes deveriam ser substituídos pelos arquivos compilados, causando problemas com lint e i18n.\"), \"\\n\", React.createElement(_components.li, null, \"Não ficou claro que o objetivo da M5 era reduzir o custo (já pago) de manter o ferramental de CoffeeScript e TypeScript.\"), \"\\n\", React.createElement(_components.li, null, \"A migração perdeu seu ETA.\"), \"\\n\", React.createElement(_components.li, null, \"A estimativa inicial da migração era de 1000 linhas por dia demandando um ano de trabalho de um único engenheiro; na prática, 100 linhas por dia eram convertidas, significando um tempo de 10 anos ou o trabalho de 10 engenheiros em um ano.\"), \"\\n\", React.createElement(_components.li, null, \"Não havia clareza sobre o que era o trabalho \\\"fundamental\\\" que demandaria 20% do time: se infraestrutura ou pagamento de dívida técnica.\"), \"\\n\", React.createElement(_components.li, null, \"Uma migração de sistemas em produção para uma nova distribuição do Ubuntu tomou boa parte da mão-de-obra de infraestrutura.\"), \"\\n\"), \"\\n\", React.createElement(_components.h2, null, \"Um novo plano com \", React.createElement(_components.code, null, \"decaffeinate\")), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"Em janeiro de 2017, foi sugerido o uso de \", React.createElement(_components.code, null, \"decaffeinate\"), \" para as conversões.\"), \"\\n\", React.createElement(_components.li, null, \"Uma função de ordenação com i18n não-testada quebrou completamente uma página no browser Safari.\"), \"\\n\", React.createElement(_components.li, null, \"A longa lista de bugs semelhantes no \", React.createElement(_components.code, null, \"decaffeinate\"), \" obrigou se adotar uma conversão mista (manual e automática) que eventualmente ocasiona erros a nível de semântica do código.\"), \"\\n\", React.createElement(_components.li, null, \"Seis meses depois, \", React.createElement(_components.code, null, \"decaffeinate\"), \" parecia suficientemente maduro em comparação à conversão manual.\"), \"\\n\", React.createElement(_components.li, null, \"O time entrou em acordo: TypeScript apenas com o tipo \", React.createElement(_components.code, null, \"any\"), \" era preferível a CoffeeScript não-tipado e habilitaria os times a introduzirem tipos no seu próprio ritmo.\"), \"\\n\"), \"\\n\", React.createElement(_components.h2, null, \"Um plano em duas fases\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"A pipeline de migração de código consistia de múltiplas etapas:\", \"\\n\", React.createElement(_components.ol, null, \"\\n\", React.createElement(_components.li, null, \"Conversão para JavaScript ES6;\"), \"\\n\", React.createElement(_components.li, null, \"Transformações com \", React.createElement(_components.code, null, \"codemod\"), \", especialmente de funções com binding para \", React.createElement(_components.em, null, \"arrow functions\"), \";\"), \"\\n\", React.createElement(_components.li, null, \"Transformação da API legada de React para JSX;\"), \"\\n\", React.createElement(_components.li, null, \"Conversão de AMD para módulos ES (especial cuidado com exports);\"), \"\\n\", React.createElement(_components.li, null, \"Anotação de parâmetros de função com \", React.createElement(_components.code, null, \"any\"), \";\"), \"\\n\", React.createElement(_components.li, null, \"Adição de declaração de membros de classes;\"), \"\\n\", React.createElement(_components.li, null, \"Anotação de componentes com tipos específicos de React;\"), \"\\n\", React.createElement(_components.li, null, \"Adição de comentário explicado como olhar o código CoffeeScript original através do \", React.createElement(_components.code, null, \"git\"), \";\"), \"\\n\"), \"\\n\"), \"\\n\", React.createElement(_components.li, null, \"A etapa final de correção dos tipos envolveu escrever scripts para interpretar os erros vindos do \", React.createElement(_components.em, null, \"type checking\"), \" e aplicar as correções automaticamente.\"), \"\\n\"), \"\\n\", React.createElement(_components.h2, null, \"Mantendo o foco\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"O compromisso de manter uma ferramenta suficientemente boa tornou trivial resolver manualmente problemas como variáveis mortas.\"), \"\\n\", React.createElement(_components.li, null, \"Agrupar a quantidade de erros do \", React.createElement(_components.code, null, \"tsc\"), \" por código de erro gerou uma métrica para a migração e confiança de que estavam na direção correta.\"), \"\\n\", React.createElement(_components.li, null, \"A taxa de erros por arquivo ficou entre 0,5 e 1.\"), \"\\n\"), \"\\n\", React.createElement(_components.h2, null, \"Ganhando confiança nas suas ferramentas\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"Bugs pré-existentes eram capturados rodando testes antes e após as conversões.\"), \"\\n\", React.createElement(_components.li, null, \"Se um erro ocorria em muitos lugares, uma asserção era adicionada à pipeline de migração em vez de realizar correção manual.\"), \"\\n\", React.createElement(_components.li, null, \"Um bug notável destes é relacionado a CoffeeScript não ter suporte a \", React.createElement(_components.em, null, \"variable shadowing\"), \".\"), \"\\n\", React.createElement(_components.li, null, \"O código foi inteiramente portado para o \", React.createElement(_components.em, null, \"strict mode\"), \" sem problemas como atribuição em propriedades \", React.createElement(_components.em, null, \"read-only\"), \".\"), \"\\n\", React.createElement(_components.li, null, \"As primeiras conversões em massa foram feitas nos testes automáticos.\"), \"\\n\", React.createElement(_components.li, null, \"Uma boa configuração do \", React.createElement(_components.a, {\n    href: \"https://www.youtube.com/watch?v=muvU1DYrY0w\"\n  }, \"itest\"), \" permitia checar rapidamente quais modificações eram a origem dos problemas.\"), \"\\n\", React.createElement(_components.li, null, \"Foi importante ter rigor na escrita das traduções de código, cobrindo todos os \", React.createElement(_components.em, null, \"corner cases\"), \" e explicitando quais casos eram ignorados.\"), \"\\n\"), \"\\n\", React.createElement(_components.h2, null, \"A última parte\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"Nas últimas semanas as ferramentas eram capazes de converter entre 100 e 200 arquivos numa única passagem.\"), \"\\n\", React.createElement(_components.li, null, \"Um dos truques para iterar rapidamente é rodar o \", React.createElement(_components.em, null, \"typecheck\"), \" incremental (\", React.createElement(_components.code, null, \"tsc --noEmit --watch\"), \").\"), \"\\n\", React.createElement(_components.li, null, \"O número de arquivos em CoffeeScript era mantido atualizado num quadro branco.\"), \"\\n\", React.createElement(_components.li, null, \"Apenas dois bugs entraram em produção.\"), \"\\n\", React.createElement(_components.li, null, \"Ao time mais resistente à mudança foi prometido que erros ficariam a cargo dos engenheiros envolvidos na migração.\"), \"\\n\", React.createElement(_components.li, null, \"Ao se admitir como produto um código TypeScript não-idiomático, foram gastos 2 meses de trabalho de três engenheiros (cerca de 19 engenheiros-semana).\"), \"\\n\", React.createElement(_components.li, null, \"\\\"Nós devemos economizar nosso capital político e organizacional com trabalhos que não podemos automatizar para todos\\\"; assim, a conversão manual foi descartada.\"), \"\\n\", React.createElement(_components.li, null, \"Atualmente, o time da Dropbox mantém 2kk linhas de TypeScript.\"), \"\\n\"));\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? React.createElement(MDXLayout, props, React.createElement(_createMdxContent, props)) : _createMdxContent(props);\n}\nexport default MDXContent;\n","import GATSBY_COMPILED_MDX from \"/home/runner/work/tassoevan.github.io/tassoevan.github.io/posts/2020-05-24/notas-sobre-the-great-coffeescript-to-typescript-migration-of-2017.mdx\";\nimport React from 'react';\nimport SEO from '../components/SEO';\nimport Layout from '../components/Layout';\nimport NavBar from '../components/NavBar';\nimport Post from '../components/Post';\nconst query = \"2179984064\";\nfunction PostTemplate(_ref) {\n  let {pageContext, data, children} = _ref;\n  const {frontmatter: {title, date}, slug, next} = pageContext;\n  const {excerpt, timeToRead} = data.mdx;\n  return React.createElement(React.Fragment, null, React.createElement(SEO, {\n    title: title,\n    description: excerpt\n  }), React.createElement(Layout, null, React.createElement(NavBar, null), React.createElement(Post, {\n    slug: slug,\n    title: title,\n    date: new Date(Date.parse(date)),\n    timeToRead: Math.ceil(timeToRead),\n    next: next\n  }, children)));\n}\nPostTemplate\nexport default function GatsbyMDXWrapper(props) {\n  return React.createElement(PostTemplate, props, React.createElement(GATSBY_COMPILED_MDX, props));\n}\n","import React from 'react';\nimport styled from 'styled-components';\nimport { useSiteMetadata } from '../hooks/useSiteMetadata';\nimport Link from './Link';\n\nconst StyledNavBar = styled.nav`\n  h1 {\n    font-size: 1em;\n    font-weight: normal;\n    margin: 0;\n  }\n`;\n\nfunction NavBar() {\n  const { title, description } = useSiteMetadata();\n\n  return (\n    <StyledNavBar>\n      <h1>\n        <Link href='/' title={description}>\n          {title}\n        </Link>\n      </h1>\n    </StyledNavBar>\n  );\n}\n\nexport default NavBar;\n","/**\n * @typedef {import('mdx/types.js').MDXComponents} MDXComponents\n * @typedef {import('react').Component<{}, {}, unknown>} Component\n * @typedef {import('react').ReactNode} ReactNode\n */\n\n/**\n * @callback MergeComponents\n *   Custom merge function.\n * @param {Readonly<MDXComponents>} currentComponents\n *   Current components from the context.\n * @returns {MDXComponents}\n *   Additional components.\n *\n * @typedef Props\n *   Configuration for `MDXProvider`.\n * @property {ReactNode | null | undefined} [children]\n *   Children (optional).\n * @property {Readonly<MDXComponents> | MergeComponents | null | undefined} [components]\n *   Additional components to use or a function that creates them (optional).\n * @property {boolean | null | undefined} [disableParentContext=false]\n *   Turn off outer component context (default: `false`).\n */\n\nimport React from 'react'\n\n/** @type {Readonly<MDXComponents>} */\nconst emptyComponents = {}\n\nconst MDXContext = React.createContext(emptyComponents)\n\n/**\n * Get current components from the MDX Context.\n *\n * @param {Readonly<MDXComponents> | MergeComponents | null | undefined} [components]\n *   Additional components to use or a function that creates them (optional).\n * @returns {MDXComponents}\n *   Current components.\n */\nexport function useMDXComponents(components) {\n  const contextComponents = React.useContext(MDXContext)\n\n  // Memoize to avoid unnecessary top-level context changes\n  return React.useMemo(\n    function () {\n      // Custom merge via a function prop\n      if (typeof components === 'function') {\n        return components(contextComponents)\n      }\n\n      return {...contextComponents, ...components}\n    },\n    [contextComponents, components]\n  )\n}\n\n/**\n * Provider for MDX context.\n *\n * @param {Readonly<Props>} properties\n *   Properties.\n * @returns {JSX.Element}\n *   Element.\n * @satisfies {Component}\n */\nexport function MDXProvider(properties) {\n  /** @type {Readonly<MDXComponents>} */\n  let allComponents\n\n  if (properties.disableParentContext) {\n    allComponents =\n      typeof properties.components === 'function'\n        ? properties.components(emptyComponents)\n        : properties.components || emptyComponents\n  } else {\n    allComponents = useMDXComponents(properties.components)\n  }\n\n  return React.createElement(\n    MDXContext.Provider,\n    {value: allComponents},\n    properties.children\n  )\n}\n"],"names":["_createMdxContent","props","_components","Object","assign","p","h2","ul","li","em","code","a","ol","_provideComponents","components","React","href","wrapper","MDXLayout","PostTemplate","_ref","pageContext","data","children","frontmatter","title","date","slug","next","excerpt","timeToRead","mdx","SEO","description","Layout","NavBar","Post","Date","parse","Math","ceil","GatsbyMDXWrapper","GATSBY_COMPILED_MDX","StyledNavBar","styled","nav","withConfig","displayName","componentId","useSiteMetadata","Link","emptyComponents","MDXContext","useMDXComponents","contextComponents"],"sourceRoot":""}